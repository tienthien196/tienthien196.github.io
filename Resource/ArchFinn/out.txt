=== DUMP CODE Tá»ª: E:\DOCS\NoteBook\Data\Network\archNetwork ===
Chá»‰ dump cÃ¡c file: .afinn, .c, .cfg, .conf, .cpp, .css, .go, .h, .hpp, .html, .ini, .java, .js, .json, .lark, .md, .py, .rs, .toml, .ts, .txt, .yaml, .yml
================================================================================

--- FILE: ceh_pentest_cheatsheet.md ---
# CEH / Penetration Testing Roadmap â€” Cheat Sheet __En__

> **Má»¥c tiÃªu:** Táº­p há»£p nhanh toÃ n bá»™ Ã½ chÃ­nh: quy trÃ¬nh pentest, crypto, recon, scanning, táº¥n cÃ´ng há»‡ thá»‘ng, web/app, wireless, malware, cÃ´ng cá»¥â€¦  

---

## Má»¥c lá»¥c
- [Basics Guide](https://chat.qwen.ai/s/6071e273-dd70-41c7-af9d-bcef7e71d448?fev=0.0.190)
- [5 Phases to a Penetration Test](#5-phases-to-a-penetration-test)
- [Attack Types](#attack-types)
- [Legal / Standards / Compliance](#legal--standards--compliance)
- [Cryptography](#cryptography)
  - [Symmetric Encryption](#symmetric-encryption)
  - [Asymmetric Encryption](#asymmetric-encryption)
  - [Hash Algorithms](#hash-algorithms)
  - [Trust Models](#trust-models)
  - [Cryptography Attacks](#cryptography-attacks)
  - [Digital Certificate Fields](#digital-certificate-fields)
- [Reconnaissance](#reconnaissance)
  - [Google Hacking Operators](#google-hacking-operators)
  - [DNS Essentials](#dns-essentials)
  - [TCP Header Flags](#tcp-header-flags)
  - [DHCP Handshake](#dhcp-handshake)
- [Scanning & Enumeration](#scanning--enumeration)
  - [ICMP Message Types](#icmp-message-types)
  - [CIDR / IPv4 Quick Notes](#cidr--ipv4-quick-notes)
  - [Port Numbers](#port-numbers)
  - [HTTP Status Families](#http-status-families)
  - [Nmap Quick Reference](#nmap-quick-reference)
  - [Scan Types Semantics](#scan-types-semantics)
  - [NetBIOS Cheats](#netbios-cheats)
  - [SNMP Notes](#snmp-notes)
- [Sniffing & Evasion](#sniffing--evasion)
  - [IPv4 vs IPv6](#ipv4-vs-ipv6)
  - [MAC Address](#mac-address)
  - [NAT](#nat)
  - [Stateful Inspection](#stateful-inspection)
  - [HTTP Tunnelling](#http-tunnelling)
  - [Snort IDS Basics](#snort-ids-basics)
  - [IDS Evasion Tactics](#ids-evasion-tactics)
  - [tcpdump Syntax](#tcpdump-syntax)
- [Attacking a System](#attacking-a-system)
  - [Password Rules (CEH style)](#password-rules-ceh-style)
  - [LM Hashing Note](#lm-hashing-note)
  - [Attack Types](#attack-types-1)
  - [Sidejacking](#sidejacking)
  - [Authentication Factors](#authentication-factors)
  - [Session Hijacking Steps](#session-hijacking-steps)
  - [Kerberos Overview](#kerberos-overview)
  - [SAM File](#sam-file)
  - [Windows Registry Essentials](#windows-registry-essentials)
- [Trojans / Malware / DoS](#trojans--malware--dos)
  - [Virus Types](#virus-types)
  - [DoS Types](#dos-types)
  - [Notable CVEs / Worms](#notable-cves--worms)
- [Web-based Hacking](#web-based-hacking)
  - [SQL Injection Types](#sql-injection-types)
  - [Buffer Overflow Quick Notes](#buffer-overflow-quick-notes)
  - [Dangerous C Functions](#dangerous-c-functions)
- [Wireless Hacking](#wireless-hacking)
  - [802.11 Specs](#80211-specs)
  - [Bluetooth Attacks](#bluetooth-attacks)
- [Physical Security](#physical-security)
- [Social Engineering](#social-engineering)
- [Linux Commands](#linux-commands)
- [Command-Line Quickies](#command-line-quickies)
- [Tools of the Trade](#tools-of-the-trade)
---

```
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ CEH / Pentest Roadmap   â”‚
                         â”‚    (Cheat Sheet)        â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                             â”‚                             â”‚
   Basics                       Cryptography                 Reconnaissance
      â”‚                             â”‚                             â”‚
 â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ 5 Phases â”‚          â”‚ Symmetric  â”‚ Asymmetric â”‚     â”‚ Google Hacking Ops    â”‚
 â”‚ Attack   â”‚          â”‚ Hash Algo  â”‚ TrustModel â”‚     â”‚ DNS Essentials        â”‚
 â”‚ Legal    â”‚          â”‚ CryptoAtk  â”‚ Certificateâ”‚     â”‚ TCP Flags             â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ DHCP Handshake        â”‚
                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                             â”‚                             â”‚
 Scanning & Enumeration        Sniffing & Evasion           Attacking System
      â”‚                             â”‚                             â”‚
 â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ ICMP Msg â”‚              â”‚ IPv4 vs IPv6      â”‚     â”‚ Password Rules          â”‚
 â”‚ CIDR/IPv4â”‚              â”‚ NAT / Firewall    â”‚     â”‚ LM Hash Note            â”‚
 â”‚ Ports    â”‚              â”‚ IDS / Snort       â”‚     â”‚ Attack Types            â”‚
 â”‚ Nmap     â”‚              â”‚ tcpdump           â”‚     â”‚ Sidejacking             â”‚
 â”‚ NetBIOS  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ Kerberos / SAM / Reg    â”‚
 â”‚ SNMP     â”‚                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                             â”‚                             â”‚
Trojans / Malware / DoS        Web / App Hacking             Wireless Hacking
      â”‚                             â”‚                             â”‚
 â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Virus   â”‚              â”‚ SQLi   â”‚ Buffer   â”‚           â”‚ 802.11 Specs      â”‚
 â”‚ DoS     â”‚              â”‚ XSS    â”‚ Overflow â”‚           â”‚ Bluetooth Attacks â”‚
 â”‚ CVEs    â”‚              â”‚ CSRF   â”‚ C Funcs  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                             â”‚                             â”‚
Physical Security            Social Engineering               Linux / Commands
      â”‚                             â”‚                             â”‚
 â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Locks    â”‚              â”‚ Human-based     â”‚           â”‚ FS Layout           â”‚
 â”‚ Cameras  â”‚              â”‚ Computer-based  â”‚           â”‚ Users / Perms       â”‚
 â”‚ Policies â”‚              â”‚ SE Types        â”‚           â”‚ Snort Rules         â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ Cmd Quickies        â”‚
                                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚ Tools of the Trade    â”‚
                             â”‚ (Scanning, Exploits,  â”‚
                             â”‚   Sniffing, Crypto,   â”‚
                             â”‚   Wireless, Webâ€¦)     â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---
## Basics

### 5 Phases to a Penetration Test
1. Reconnaissance  
2. Scanning & Enumeration  
3. Gaining Access  
4. Maintaining Access  
5. Covering Tracks

### Attack Types
- **OS**: Táº¥n cÃ´ng cáº¥u hÃ¬nh máº·c Ä‘á»‹nh cá»§a há»‡ Ä‘iá»u hÃ nh
- **App level**: Táº¥n cÃ´ng mÃ£ á»©ng dá»¥ng
- **Shrink Wrap**: Táº­n dá»¥ng script/off-the-shelf
- **Misconfiguration**: Cáº¥u hÃ¬nh kÃ©m

### Legal / Standards / Compliance
- 18 U.S.C 1029 & 1030  
- RFC 1918 â€“ Private IP Standard  
- RFC 3227 â€“ Collecting & storing data  
- ISO 27002 â€“ InfoSec Guidelines  
- CAN-SPAM â€“ email marketing  
- SPY-Act â€“ License Enforcement  
- DMCA â€“ Intellectual Property  
- SOX â€“ Corporate Finance Processes  
- GLBA â€“ Personal Finance Data  
- FERPA â€“ Education Records  
- FISMA â€“ Gov Networks Security Std  
- CVSS â€“ Common Vulnerability Scoring System  
- CVE â€“ Common Vulnerabilities & Exposures  
- Regional Registry Coverage Map

---

## Cryptography

### Symmetric Encryption
- **Key pairs required =** 1 (shared secret)  
- **Algorithms:**
  - DES: 56-bit key (8-bit parity); fixed block
  - 3DES: 168-bit key; keys â‰¤ 3
  - AES: 128/192/256; thay DES
  - IDEA: 128-bit key
  - Twofish: block cipher, key â‰¤ 256-bit
  - Blowfish: thay bá»Ÿi AES; 64-bit block
  - RC family: RC2â†’RC6; RC6 128-bit block; tá»‘i Ä‘a ~2040-bit key

### Asymmetric Encryption
- **Public Key = Encrypt**, **Private Key = Decrypt** (thÃ´ng thÆ°á»ng)  
- **Algorithms:**
  - Diffieâ€“Hellman: Trao Ä‘á»•i khÃ³a; dÃ¹ng trong SSL/IPsec
  - ECC: Elliptic Curve â€“ hiá»‡u quáº£ cho mobile/low-power
  - ElGamal: Dá»±a trÃªn log rá»i ráº¡c; mÃ£ hÃ³a/kÃ½
  - RSA: 2 sá»‘ nguyÃªn tá»‘ lá»›n; key phá»• biáº¿n Ä‘áº¿n 4096-bit

### Hash Algorithms
- MD5: 128-bit hash, biá»ƒu diá»…n 32 hex
- SHA-1: 160-bit hash
- SHA-2: 224/256/384/512

### Trust Models
- **Web of Trust**: Thá»±c thá»ƒ kÃ½ chÃ©o
- **Single Authority**: 1 CA gá»‘c
- **Hierarchical**: CA gá»‘c + RA cáº¥p dÆ°á»›i
- **XMKS**: XML PKI System

### Cryptography Attacks
- **Known Plain-text**: So chuá»—i láº·p láº¡i cá»§a báº£n rÃµ
- **Ciphertext-only**: Thu tháº­p nhiá»u báº£n mÃ£, phÃ¢n tÃ­ch máº«u
- **Replay (MITM)**: Láº·p láº¡i trao Ä‘á»•i Ä‘á»ƒ lá»«a thiáº¿t láº­p kÃªnh

### Digital Certificate Fields
- Version, Serial
- Subject, Issuer
- Algorithm ID
- Valid from/to
- Key usage
- Subjectâ€™s Public Key
- Optional: Issuer ID, Subject Alt Name, â€¦

---

## Reconnaissance

### Äá»‹nh nghÄ©a
- **Recon**: Thu tháº­p thÃ´ng tin má»¥c tiÃªu (CEH dÃ¹ng thay footprinting).
- **Footprinting**: Váº½ báº£n Ä‘á»“ tá»•ng quan á»Ÿ má»©c cao.

### Google Hacking Operators
- `operator:keyword`
- `site:` â€“ trong domain
- `ext:` â€“ pháº§n má»Ÿ rá»™ng tá»‡p
- `loc:` â€“ vá»‹ trÃ­ báº£n Ä‘á»“
- `intitle:` / `allintitle:`
- `inurl:` / `allinurl:`
- `incache:` â€“ chá»‰ cache

### DNS Essentials
- **Port** 53 â€“ UDP (truy váº¥n), TCP (zone transfer)  
- **Records:**
  - SRV â€“ hostname & port dá»‹ch vá»¥
  - SOA â€“ Primary name server
  - PTR â€“ IPâ†’Hostname (reverse DNS)
  - NS â€“ Name servers
  - MX â€“ Mail servers
  - CNAME â€“ bÃ­ danh (alias)
  - A â€“ Hostnameâ†’IP
- **Footprinting tools**: `whois`, `nslookup`, `dig`

### TCP Header Flags
- **URG** â€“ out-of-band data  
- **ACK** â€“ xÃ¡c nháº­n (sau SYN)  
- **PSH** â€“ Ä‘áº©y dá»¯ liá»‡u khÃ´ng buffer  
- **RST** â€“ reset káº¿t ná»‘i 2 chiá»u  
- **SYN** â€“ má»Ÿ káº¿t ná»‘i, tham sá»‘ & seq  
- **FIN** â€“ Ä‘Ã³ng káº¿t ná»‘i cÃ³ thá»© tá»±

### DHCP Handshake
Client â€”**Discover**â†’ Server  
Client â†**Offer**â€” Server  
Client â€”**Request**â†’ Server  
Client â†**Ack**â€” Server (IP bá»‹ rÃºt khá»i pool)

---

## Scanning & Enumeration

### ICMP Message Types
- **0**: Echo Reply  
- **3**: Destination Unreachable (Codes: 0 network, 1 host, 6 network unknown, 7 host unknown, 9/10 admin prohibited, 13 comms admin prohibited)  
- **4**: Source Quench (cÅ©)  
- **5**: Redirect (0 network, 1 host)  
- **8**: Echo Request  
- **11**: Time Exceeded

### CIDR / IPv4 Quick Notes
- `/30 = 4  (.255.252)`  
- `/28 = 16 (.255.240)`  
- `/26 = 64 (.255.192)`  
- `/24 = 256 (.255.0)`  
- `/22 = 1024 (.248.0)`  
- `/20 = 4096 (.240.0)`  

### Port Numbers
- **0â€“1023**: Well-known  
- **1024â€“49151**: Registered  
- **49152â€“65535**: Dynamic

**Important ports**
- FTP: 20/21
- SSH: 22
- Telnet: 23
- SMTP: 25
- WINS: 42
- TACACS: 49
- DNS: 53
- HTTP: 80 / 8080
- Kerberos: 88
- POP3: 110
- Portmapper (Linux): 111
- NNTP: 119
- NTP: 123
- RPC-DCOM: 135
- NetBIOS/SMB: 137â€“139
- IMAP: 143
- SNMP: 161/162
- LDAP: 389
- HTTPS: 443
- CIFS: 445
- RADIUS: 1812
- RDP: 3389
- IRC: 6667
- Printer: 515, 631, 9100
- Tini: 7777
- NetBus: 12345
- Back Orifice: 27374
- Sub7: 31337

### HTTP Status Families
- **200** series â€“ OK  
- **400** series â€“ Client error / Could not provide request  
- **500** series â€“ Server error / Could not process request

### Nmap Quick Reference
```bash
nmap <scan options> <target>
# Popular:
-sS (SYN) -sT (TCP connect) -sA (ACK) -sF (FIN) -sN (NULL) -sX (XMAS) -sW (Window)
-sn (ping sweep) -sI (Idle) -sR (RPC) -PS (SYN ping) -PI (ICMP ping) -PT (TCP ping)
-Po (no ping) -A (OS/Version/Script) -oN (normal) -oX (XML) -T0..T4 (cháº­mâ†’nhanh)
```

### Scan Types Semantics
- **TCP (full 3-way)**: Open = SYN/ACK; Closed = RST/ACK  
- **SYN (half-open)**: Open = SYN/ACK; Closed = RST/ACK  
- **FIN**: Open = no response; Closed = RST  
- **XMAS (FIN, URG, PSH)**: Open = no response; Closed = RST  
- **ACK (Linux/Unix)**: Open = RST; Closed = no response  
- **IDLE (spoofed)**: Open = SYN/ACK; Closed = RST/ACK  
- **NULL (no flags)**: Phá»¥ thuá»™c OS (Linux/Unix oriented)

### NetBIOS Cheats
```bash
nbtstat -a COMPUTER190         # remote table by name
nbtstat -A 192.168.10.12       # remote table by IP
nbtstat -n                     # local name table
nbtstat -c                     # local name cache
nbtstat -r                     # purge name cache
nbtstat -S 10                  # session stats every 10s
# 1B = master browser (subnet), 1C = domain controller, 1D = domain master browser
```

### SNMP Notes
- DÃ¹ng **community string** nhÆ° máº­t kháº©u (v1/v2c)
- **SNMPv3** mÃ£ hÃ³a & xÃ¡c thá»±c community/traffic

---

## Sniffing & Evasion

### IPv4 vs IPv6
- **IPv4**: unicast, multicast, **broadcast**
- **IPv6**: unicast, multicast, **anycast**; pháº¡m vi: link-local, site-local, global

### MAC Address
- 3 byte Ä‘áº§u (OUI â€“ Org Unique ID) + 3 byte sau (serial)

### NAT
- **Basic NAT**: 1â€“1 privateâ†”public  
- **PAT (NAT Overload)**: Port Address Translation (thÆ°á»ng dÃ¹ng)

### Stateful Inspection
- Kiá»ƒm soÃ¡t theo **state** káº¿t ná»‘i; khÃ´ng soi tá»«ng gÃ³i

### HTTP Tunnelling
- Bá»c payload qua port Ã­t bá»‹ cháº·n (vÃ­ dá»¥ 80)

### Snort IDS Basics
- 3 cháº¿ Ä‘á»™: **Sniffer / Packet logger / NIDS**  
- Config: `/etc/snort` hoáº·c `C:\snort\etc`  
- VÃ­ dá»¥ rule:
```snort
alert tcp !HOME_NET any -> $HOME_NET 31337 (msg:"BACKDOOR ATTEMPT-Backorifice.";)
```

### IDS Evasion Tactics
- **Cháº­m láº¡i** / **flood** / **fragmentation**

### tcpdump Syntax
```bash
tcpdump [flags] <interface>
```

---

## Attacking a System

### Password Rules (CEH style)
- KhÃ´ng chá»©a tÃªn user, tá»‘i thiá»ƒu **8** kÃ½ tá»±, **3/4** nhÃ³m: Ä‘áº·c biá»‡t, sá»‘, chá»¯ hoa, chá»¯ thÆ°á»ng

### LM Hashing Note
- 7 spaces hashed: `AAD3B435B51404EE`

### Attack Types
- **Passive Online**: sniff/replay/MITM
- **Active Online**: Ä‘oÃ¡n máº­t kháº©u
- **Offline**: trá»™m SAM, crack ngoáº¡i tuyáº¿n
- **Non-electronic**: social engineering

### Sidejacking
- ÄÃ¡nh cáº¯p cookie vÃ  **replay**

### Authentication Factors
- **Type 1**: Something you know  
- **Type 2**: Something you have  
- **Type 3**: Something you are

### Session Hijacking Steps
1. Sniff traffic clientâ†”server  
2. Theo dÃµi & dá»± Ä‘oÃ¡n sequence  
3. **Desynchronize** client  
4. ÄoÃ¡n **session token**  
5. Inject packet vÃ o server

### Kerberos Overview
- **ThÃ nh pháº§n**: KDC, AS, TGS, TGT  
- **Quy trÃ¬nh tÃ³m táº¯t**: Client xin TGT (cleartext req) â†’ Server tráº£ key bÄƒm theo pass trÃªn AD (TGT) â†’ DÃ¹ng TGT xin TGS â†’ Nháº­n ticket Ä‘á»ƒ truy cáº­p tÃ i nguyÃªn

### SAM File
- `C:\Windows\System32\config`

### Windows Registry Essentials
- **Root Keys**:  
  - HKLM â€“ thÃ´ng tin HW/SW  
  - HKCR â€“ file associations & OLE classes  
  - HKCU â€“ profile user hiá»‡n táº¡i  
  - HKEY_USERS â€“ cáº¥u hÃ¬nh má»i user active  
  - HKCC â€“ Hardware Profiles  
- **Run Keys**:  
  `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run*` / `RunServices*`

---

## Social Engineering
- **Human-based**: Dumpster diving, impersonation, help desk, shoulder surfing, tailgating/piggybacking
- **Computer-based**: Phishing, **Whaling** (CEO), **Pharming** (evil twin)
- **Types of SE**:  
  - Insider Associates (quyá»n háº¡n giá»›i háº¡n)  
  - Insider Affiliates (giáº£ máº¡o Insider)  
  - Outsider Affiliates (káº» ngoÃ i lá»£i dá»¥ng Ä‘iá»ƒm má»Ÿ)

---

## Physical Security
- **Physical**: cá»­a, khÃ³a, cameraâ€¦  
- **Technical**: smartcards, biometrics  
- **Operational**: chÃ­nh sÃ¡ch & quy trÃ¬nh

---

## Web-based Hacking
- **CSRF**
- **Dot-dot-slash** (path traversal, unicode/invalid input)

### SQL Injection Types
- **Union Query**
- **Tautology**
- **Blind SQLi**
- **Error-based** (enumeration)

### Buffer Overflow Quick Notes
- Ghi vÆ°á»£t bá»™ Ä‘á»‡m â†’ há»ng dá»¯ liá»‡u / thá»±c thi mÃ£
- **Stack**: thay Ä‘á»•i function pointer/var
- **Heap**: overwrite function pointers vÃ¹ng heap
- **NOP Sled**: chuá»—i NOP lá»›n (IDS thÆ°á»ng cháº·n)

### Dangerous C Functions
- `gets()` `strcpy()` `strcat()` `printf()` (khÃ´ng kiá»ƒm kÃ­ch thÆ°á»›c Ä‘Ã­ch)

---

## Wireless Hacking

### 802.11 Specs
- **WEP**: RC4 + 24-bit IV; key 40/104-bit  
- **WPA**: RC4; IV 48-bit  
- **WPA/TKIP**: Ä‘á»•i IV má»—i frame + key mixing  
- **WPA2**: AES + tÃ­nh nÄƒng TKIP; IV 48-bit

| Spec    | Dist | Speed   | Freq     |
|---------|------|---------|----------|
| 802.11a | 30m  | 54 Mbps | 5 GHz    |
| 802.11b | 100m | 11 Mbps | 2.4 GHz  |
| 802.11g | 100m | 54 Mbps | 2.4 GHz  |
| 802.11n | 125m | 100+ Mb | 2.4/5GHz |

### Bluetooth Attacks
- **Bluesmacking** (DoS)  
- **Bluejacking** (nháº¯n tin)  
- **Bluesniffing** (sniff)  
- **Bluesnarfing** (trá»™m dá»¯ liá»‡u)

---

## Trojans / Malware / DoS

### Virus Types
- Boot, Camouflage, Cavity, Macro, Multipartite
- Metamorphic, Network, Polymorphic Code
- Shell, Stealth

### DoS Types
- **SYN Attack/Flood**, **ICMP Flood**, **App-level Flood**
- **Smurf** (ICMP broadcast spoofed), **Fraggle** (UDP)
- **Ping of Death** (reassembly > max size)

### Notable CVEs / Worms
- **Heartbleed** (CVE-2014-0160) â€“ OpenSSL heartbeat leak (MITM)
- **POODLE** (CVE-2014-3566) â€“ SSL 3.0 downgrade MITM
- **Shellshock** (CVE-2014-6271) â€“ Bash code injection via env
- **ILOVEYOU** (2000, VBS macro) â€“ from Philippines
- **Melissa** (1999, MS Word macro)

---

## Linux Commands

### FS Layout
`/` (root), `/var` (logs), `/bin` (user bins), `/sbin` (admin bins), `/root`, `/boot` (kernel), `/proc` (kernel), `/dev` (devices), `/mnt` (mount)

### Users / Procs / IDs
- `init` PID 1  
- root UID/GID 0  
- Services 1â€“999  
- Users â‰¥ 1000

### Permissions
- 4 Read / 2 Write / 1 Execute  
- `764` = User RWX / Group RW / Other R

### Snort Rule Form
```
action protocol src_ip src_port -> dst_ip dst_port (option:value; ...)
alert tcp 10.0.0.1 25 -> 10.0.0.2 25 (msg:"Sample Alert"; sid:1000;)
```

---

## Command-Line Quickies

```bash
# Nmap
nmap -sT -T5 -n -p 1-100 10.0.0.1

# Netcat
nc -v -z -w 2 10.0.0.1 1-1000

# tcpdump
tcpdump -i eth0 -v -X ip proto 1

# Snort
snort -vde -c my.rules

# hping
hping3 -I eth0 -c 10 -a 2.2.2.2 -t 100 10.0.0.1

# iptables
iptables -A FORWARD -j ACCEPT -p tcp --dport 80
```

---

## Tools of the Trade

### Vulnerability Research
- National Vuln DB, Eccouncil.org, Exploit-DB

### Foot-printing
- Netcraft, Wayback/Archive, Webmaster tools
- DNS & WHOIS: nslookup, Sam Spade, ARIN, WhereisIP, DNSstuff, DNS-Digger
- Mirroring: `wget`, Wayback, Google Cache

### Scanning & Enumeration
- Ping Sweep: Angry IP Scanner, MegaPing
- Scanners: SuperScan, Nmap (Zenmap), NetScan Tools Pro, hping, netcat
- War Dialing: THC-Scan, TeleSweep, ToneLoc, WarVox
- Banner grab: telnet, ID Serve, Netcraft, Xprobe
- Vuln Scan: Nessus, SAINT, Retina, Core Impact, Nikto
- Mapping: NetMapper, LANState, IPSonar
- Proxy/Tunnel/Anon: Tor, ProxySwitcher, ProxyChains, SoftCab, HTTP Tunnel, Anonymouse
- Enumeration: SuperScan, User2Sid/Sid2User, LDAP Admin, Xprobe, Hyena
- SNMP Enum: SolarWinds, SNMPUtil, SNMPScanner

### System Hacking
- Password: Cain, John, LCP, THC-Hydra, ElcomSoft, Aircrack, RainbowCrack, Brutus, KerbCrack
- Sniffing: Wireshark, Ace, KerbSniff, Ettercap
- Keylogger/Screen: KeyProwler, Ultimate Keylogger, All In One, Actual Spy, Ghost, Hidden Recorder, Desktop Spy, USB Grabber
- Priv Esc / Recovery: Password Recovery Boot Disk/Reset, System Recovery
- Remote Exec: PDQ Deploy, RemoteExec, Dameware
- Spyware/Monitor: Remote Desktop Spy, Activity Monitor, OSMonitor, SSPro, Spector Pro
- Cover Tracks: ELsave, CCleaner, EraserPro, Evidence Eliminator

### Packet Crafting / Spoofing
- Komodia, hping2/3, PackEth, Packet Generator, NetScan, Scapy, Nemesis

### Session Hijacking
- Paros Proxy, Burp Suite, Firesheep, Hamster/Ferret, Ettercap, Hunt

### Crypto / Stego / Hash
- Encryption: TrueCrypt, BitLocker, DriveCrypt
- Hash: MD5 Hash, HashCalc
- Stego: XPTools, ImageHide, Merge Streams, StegParty, gifShuffle, QuickStego, InvisibleSecrets, EZStego, OmniHidePro
- Cryptanalysis: Cryptobench

### Sniffing (Packet Capture)
- Wireshark, CACE, tcpdump, Capsa, OmniPeek, WinDump, dnsstuff, EtherApe

### Wireless
- Discovery: Kismet, NetStumbler, inSSIDer, NetSurveyor
- Sniffing: Cascade Pilot, OmniPeek, CommView, Capsa
- WEP/WPA: Aircrack, KisMAC, Wireless Security Auditor, WepAttack, WepCrack, coWPAtty
- Bluetooth: BTBrowser, BH Bluejack, BTScanner, Bluesnarfer
- Mobile Tracking: Whereâ€™s My Droid, Find My iPhone, GadgetTrack, iHound

### Trojans / Malware
- Wrappers: Elite Wrap
- Monitoring: HiJackThis, CurrPorts, fport
- Attack: netcat, Nemesis

### IDS / Evasion
- IDS: Snort
- Evasion: ADMutate, NIDSBench, IDSInformer, Inundator

### Web Attacks
- Recon & Audit: Wfetch, httprecon, ID Serve, WebSleuth, Black Widow, CookieDigger, NStalker, NetBrute
- SQLi: BSQL Hacker, Marathon, SQL Injection Brute, SQL Brute, SQLNinja, SQLGET

---


================================================================================

--- FILE: ComputerNetwork.md ---
# Computer Network: A Comprehensive Guide

> TÃ i liá»‡u nÃ y Ä‘Æ°á»£c xÃ¢y dá»±ng Ä‘á»ƒ cung cáº¥p má»™t cÃ¡i nhÃ¬n toÃ n diá»‡n vá» Máº¡ng MÃ¡y tÃ­nh, tá»« cÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n Ä‘áº¿n cÃ¡c ká»¹ thuáº­t nÃ¢ng cao, phá»¥c vá»¥ má»¥c Ä‘Ã­ch lÆ°u trá»¯ vÃ  tham kháº£o cho cÃ¡c dá»± Ã¡n IT. TÃ i liá»‡u Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ há»— trá»£ cáº£ ngÆ°á»i má»›i báº¯t Ä‘áº§u vÃ  nhá»¯ng ngÆ°á»i cÃ³ kinh nghiá»‡m muá»‘n há»‡ thá»‘ng hÃ³a kiáº¿n thá»©c.

---

## Má»¥c Lá»¥c

- [Giá»›i thiá»‡u vá» Computer Network](#giá»›i-thiá»‡u-vá»-computer-network)
- [CÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n](#cÃ¡c-khÃ¡i-niá»‡m-cÆ¡-báº£n)
  - [MÃ´ hÃ¬nh OSI](#mÃ´-hÃ¬nh-osi)
  - [MÃ´ hÃ¬nh TCP/IP](#mÃ´-hÃ¬nh-tcp-ip)
  - [CÃ¡c loáº¡i máº¡ng](#cÃ¡c-loáº¡i-máº¡ng)
- [CÃ¡c giao thá»©c máº¡ng chÃ­nh](#cÃ¡c-giao-thá»©c-máº¡ng-chÃ­nh)
  - [Giao thá»©c táº§ng á»©ng dá»¥ng](#giao-thá»©c-táº§ng-á»©ng-dá»¥ng)
  - [Giao thá»©c táº§ng giao váº­n](#giao-thá»©c-táº§ng-giao-váº­n)
  - [Giao thá»©c táº§ng máº¡ng](#giao-thá»©c-táº§ng-máº¡ng)
  - [Giao thá»©c táº§ng liÃªn káº¿t dá»¯ liá»‡u](#giao-thá»©c-táº§ng-liÃªn-káº¿t-dá»¯-liá»‡u)
- [CÃ¡c thiáº¿t bá»‹ máº¡ng](#cÃ¡c-thiáº¿t-bá»‹-máº¡ng)
  - [Router](#router)
  - [Switch](#switch)
  - [Access Point](#access-point)
  - [Firewall](#firewall)
- [CÃ¡c ká»¹ thuáº­t tá»‘i Æ°u hÃ³a máº¡ng](#cÃ¡c-ká»¹-thuáº­t-tá»‘i-Æ°u-hÃ³a-máº¡ng)
  - [Load Balancing](#load-balancing)
  - [Quality of Service (QoS)](#quality-of-service-qos)
  - [Network Security](#network-security)
- [Checklist há»c táº­p vÃ  nghiÃªn cá»©u](#checklist-há»c-táº­p-vÃ -nghiÃªn-cá»©u)
- [CÃ´ng cá»¥ Ä‘á» xuáº¥t](#cÃ´ng-cá»¥-Ä‘á»-xuáº¥t)
- [Kinh nghiá»‡m thá»±c hÃ nh](#kinh-nghiá»‡m-thá»±c-hÃ nh)
- [TÃ i liá»‡u tham kháº£o](#tÃ i-liá»‡u-tham-kháº£o)

---

## Giá»›i thiá»‡u vá» Computer Network

Máº¡ng mÃ¡y tÃ­nh lÃ  táº­p há»£p cÃ¡c thiáº¿t bá»‹ Ä‘Æ°á»£c káº¿t ná»‘i vá»›i nhau Ä‘á»ƒ chia sáº» tÃ i nguyÃªn, trao Ä‘á»•i dá»¯ liá»‡u vÃ  cung cáº¥p cÃ¡c dá»‹ch vá»¥. Máº¡ng mÃ¡y tÃ­nh Ä‘Ã³ng vai trÃ² quan trá»ng trong má»i lÄ©nh vá»±c tá»« giao tiáº¿p cÃ¡ nhÃ¢n, doanh nghiá»‡p, Ä‘áº¿n cÃ¡c á»©ng dá»¥ng cÃ´ng nghá»‡ cao nhÆ° trÃ­ tuá»‡ nhÃ¢n táº¡o vÃ  blockchain.

- **Táº§m quan trá»ng**:
  - Káº¿t ná»‘i toÃ n cáº§u thÃ´ng qua Internet.
  - Há»— trá»£ cÃ¡c á»©ng dá»¥ng thá»i gian thá»±c nhÆ° video streaming, VoIP, vÃ  game online.
  - LÃ  ná»n táº£ng cho cÃ¡c cÃ´ng nghá»‡ hiá»‡n Ä‘áº¡i nhÆ° cloud computing vÃ  IoT.

- **á»¨ng dá»¥ng thá»±c táº¿**:
  - XÃ¢y dá»±ng máº¡ng ná»™i bá»™ (LAN) cho doanh nghiá»‡p.
  - Triá»ƒn khai há»‡ thá»‘ng cloud (AWS, Azure).
  - PhÃ¡t triá»ƒn cÃ¡c á»©ng dá»¥ng phÃ¢n tÃ¡n (blockchain, P2P).

---

## CÃ¡c khÃ¡i niá»‡m cÆ¡ báº£n

### MÃ´ hÃ¬nh OSI
- **MÃ´ táº£**: MÃ´ hÃ¬nh OSI (Open Systems Interconnection) lÃ  má»™t khung tham chiáº¿u lÃ½ thuyáº¿t chia quÃ¡ trÃ¬nh truyá»n thÃ´ng máº¡ng thÃ nh 7 táº§ng (Layers).
- **CÃ¡c táº§ng**:
  1. **Physical Layer**: Truyá»n tÃ­n hiá»‡u váº­t lÃ½ (cÃ¡p, tÃ­n hiá»‡u Ä‘iá»‡n, quang).
  2. **Data Link Layer**: Äáº£m báº£o truyá»n dá»¯ liá»‡u khÃ´ng lá»—i giá»¯a cÃ¡c nÃºt liá»n ká» (MAC address, Ethernet).
  3. **Network Layer**: Äá»‹nh tuyáº¿n vÃ  chuyá»ƒn tiáº¿p gÃ³i tin (IP address, routing).
  4. **Transport Layer**: Äáº£m báº£o truyá»n dá»¯ liá»‡u Ä‘Ã¡ng tin cáº­y (TCP, UDP).
  5. **Session Layer**: Quáº£n lÃ½ phiÃªn giao tiáº¿p giá»¯a cÃ¡c á»©ng dá»¥ng.
  6. **Presentation Layer**: Chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng dá»¯ liá»‡u (mÃ£ hÃ³a, nÃ©n).
  7. **Application Layer**: Giao diá»‡n cho ngÆ°á»i dÃ¹ng (HTTP, FTP, DNS).
- **Æ¯u Ä‘iá»ƒm**: Cung cáº¥p cÃ¡ch tiáº¿p cáº­n chuáº©n hÃ³a Ä‘á»ƒ thiáº¿t káº¿ vÃ  phÃ¢n tÃ­ch máº¡ng.
- **VÃ­ dá»¥ thá»±c táº¿**: PhÃ¢n tÃ­ch gÃ³i tin báº±ng Wireshark dá»±a trÃªn cÃ¡c táº§ng OSI.

### MÃ´ hÃ¬nh TCP/IP
- **MÃ´ táº£**: MÃ´ hÃ¬nh TCP/IP lÃ  má»™t mÃ´ hÃ¬nh thá»±c tiá»…n, Ä‘Æ¡n giáº£n hÆ¡n OSI, gá»“m 4 táº§ng, Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong Internet.
- **CÃ¡c táº§ng**:
  1. **Link Layer**: TÆ°Æ¡ng á»©ng vá»›i Physical vÃ  Data Link Layer cá»§a OSI.
  2. **Internet Layer**: TÆ°Æ¡ng á»©ng vá»›i Network Layer (IP).
  3. **Transport Layer**: TÆ°Æ¡ng á»©ng vá»›i Transport Layer (TCP, UDP).
  4. **Application Layer**: Bao gá»“m Session, Presentation, vÃ  Application Layer cá»§a OSI.
- **Æ¯u Ä‘iá»ƒm**: ÄÆ¡n giáº£n, thá»±c tiá»…n, lÃ  ná»n táº£ng cá»§a Internet.
- **VÃ­ dá»¥ thá»±c táº¿**: Giao thá»©c HTTP cháº¡y trÃªn TCP/IP Ä‘á»ƒ truy cáº­p website.

### CÃ¡c loáº¡i máº¡ng
- **LAN (Local Area Network)**: Máº¡ng ná»™i bá»™, pháº¡m vi nhá» (vÄƒn phÃ²ng, nhÃ  á»Ÿ).
- **WAN (Wide Area Network)**: Máº¡ng diá»‡n rá»™ng, káº¿t ná»‘i cÃ¡c khu vá»±c Ä‘á»‹a lÃ½ (Internet).
- **MAN (Metropolitan Area Network)**: Máº¡ng Ä‘Ã´ thá»‹, káº¿t ná»‘i trong má»™t thÃ nh phá»‘.
- **PAN (Personal Area Network)**: Máº¡ng cÃ¡ nhÃ¢n (Bluetooth, USB).
- **VPN (Virtual Private Network)**: Máº¡ng riÃªng áº£o, mÃ£ hÃ³a dá»¯ liá»‡u qua Internet.
- **VÃ­ dá»¥ thá»±c táº¿**:
  - LAN: Máº¡ng Wi-Fi trong nhÃ .
  - WAN: Káº¿t ná»‘i Internet giá»¯a cÃ¡c quá»‘c gia.
  - VPN: Sá»­ dá»¥ng OpenVPN Ä‘á»ƒ truy cáº­p máº¡ng cÃ´ng ty tá»« xa.

---

## CÃ¡c giao thá»©c máº¡ng chÃ­nh

### Giao thá»©c táº§ng á»©ng dá»¥ng
- **HTTP/HTTPS**: Giao thá»©c truyá»n siÃªu vÄƒn báº£n, sá»­ dá»¥ng cho web.
- **DNS**: Chuyá»ƒn Ä‘á»•i tÃªn miá»n thÃ nh Ä‘á»‹a chá»‰ IP.
- **FTP/SFTP**: Truyá»n tá»‡p tin giá»¯a client vÃ  server.
- **SMTP/POP3/IMAP**: Giao thá»©c cho email.
- **VÃ­ dá»¥ thá»±c táº¿**:
  - Truy cáº­p website qua HTTPS (port 443).
  - Sá»­ dá»¥ng DNS Ä‘á»ƒ phÃ¢n giáº£i `google.com` thÃ nh `172.217.167.78`.

### Giao thá»©c táº§ng giao váº­n
- **TCP (Transmission Control Protocol)**: Äáº£m báº£o truyá»n dá»¯ liá»‡u Ä‘Ã¡ng tin cáº­y, cÃ³ káº¿t ná»‘i, kiá»ƒm tra lá»—i.
- **UDP (User Datagram Protocol)**: Truyá»n dá»¯ liá»‡u nhanh, khÃ´ng cáº§n káº¿t ná»‘i, khÃ´ng Ä‘áº£m báº£o lá»—i (dÃ¹ng cho streaming, game).
- **VÃ­ dá»¥ thá»±c táº¿**:
  - TCP: Táº£i xuá»‘ng tá»‡p tin qua FTP.
  - UDP: Truyá»n video trá»±c tiáº¿p qua Zoom.

### Giao thá»©c táº§ng máº¡ng
- **IP (Internet Protocol)**: Äá»‹nh tuyáº¿n gÃ³i tin qua máº¡ng (IPv4, IPv6).
- **ICMP**: Giao thá»©c kiá»ƒm tra tráº¡ng thÃ¡i máº¡ng (dÃ¹ng cho `ping`).
- **ARP**: Ãnh xáº¡ Ä‘á»‹a chá»‰ IP sang Ä‘á»‹a chá»‰ MAC.
- **VÃ­ dá»¥ thá»±c táº¿**:
  - IPv4: `192.168.1.1` cho máº¡ng ná»™i bá»™.
  - ICMP: Sá»­ dá»¥ng lá»‡nh `ping` Ä‘á»ƒ kiá»ƒm tra káº¿t ná»‘i.

### Giao thá»©c táº§ng liÃªn káº¿t dá»¯ liá»‡u
- **Ethernet**: Giao thá»©c phá»• biáº¿n cho máº¡ng LAN.
- **PPP (Point-to-Point Protocol)**: Káº¿t ná»‘i trá»±c tiáº¿p giá»¯a hai nÃºt.
- **Wi-Fi (IEEE 802.11)**: Giao thá»©c cho máº¡ng khÃ´ng dÃ¢y.
- **VÃ­ dá»¥ thá»±c táº¿**:
  - Ethernet: Káº¿t ná»‘i mÃ¡y tÃ­nh qua cÃ¡p RJ45.
  - Wi-Fi: Káº¿t ná»‘i khÃ´ng dÃ¢y qua chuáº©n 802.11ac/ax.

---

## CÃ¡c thiáº¿t bá»‹ máº¡ng

### Router
- **MÃ´ táº£**: Chuyá»ƒn tiáº¿p gÃ³i tin giá»¯a cÃ¡c máº¡ng khÃ¡c nhau, hoáº¡t Ä‘á»™ng á»Ÿ táº§ng máº¡ng.
- **Chá»©c nÄƒng**: Äá»‹nh tuyáº¿n, NAT (Network Address Translation), DHCP.
- **VÃ­ dá»¥ thá»±c táº¿**: Router Wi-Fi TP-Link Archer cung cáº¥p káº¿t ná»‘i Internet cho máº¡ng gia Ä‘Ã¬nh.

### Switch
- **MÃ´ táº£**: Káº¿t ná»‘i cÃ¡c thiáº¿t bá»‹ trong cÃ¹ng má»™t máº¡ng, hoáº¡t Ä‘á»™ng á»Ÿ táº§ng liÃªn káº¿t dá»¯ liá»‡u.
- **Chá»©c nÄƒng**: Chuyá»ƒn tiáº¿p khung dá»¯ liá»‡u (frame) dá»±a trÃªn Ä‘á»‹a chá»‰ MAC.
- **VÃ­ dá»¥ thá»±c táº¿**: Switch Cisco Catalyst cho máº¡ng doanh nghiá»‡p.

### Access Point
- **MÃ´ táº£**: Thiáº¿t bá»‹ cung cáº¥p káº¿t ná»‘i Wi-Fi cho cÃ¡c thiáº¿t bá»‹.
- **Chá»©c nÄƒng**: Káº¿t ná»‘i khÃ´ng dÃ¢y, má»Ÿ rá»™ng pháº¡m vi máº¡ng.
- **VÃ­ dá»¥ thá»±c táº¿**: Ubiquiti UniFi AP cho máº¡ng Wi-Fi doanh nghiá»‡p.

### Firewall
- **MÃ´ táº£**: Thiáº¿t bá»‹ báº£o máº­t, kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng máº¡ng dá»±a trÃªn quy táº¯c.
- **Chá»©c nÄƒng**: NgÄƒn cháº·n truy cáº­p trÃ¡i phÃ©p, báº£o vá»‡ máº¡ng khá»i táº¥n cÃ´ng.
- **VÃ­ dá»¥ thá»±c táº¿**: pfSense, Fortinet Firewall cho máº¡ng doanh nghiá»‡p.

---

## CÃ¡c ká»¹ thuáº­t tá»‘i Æ°u hÃ³a máº¡ng

### Load Balancing
- **MÃ´ táº£**: PhÃ¢n phá»‘i lÆ°u lÆ°á»£ng máº¡ng Ä‘á»u trÃªn nhiá»u server Ä‘á»ƒ tÄƒng hiá»‡u suáº¥t vÃ  Ä‘á»™ tin cáº­y.
- **CÃ¡c ká»¹ thuáº­t**:
  - Round-robin: PhÃ¢n phá»‘i tuáº§n tá»±.
  - Least connections: Gá»­i lÆ°u lÆ°á»£ng Ä‘áº¿n server Ã­t káº¿t ná»‘i nháº¥t.
- **VÃ­ dá»¥ thá»±c táº¿**: Sá»­ dá»¥ng NGINX lÃ m load balancer cho web server.

### Quality of Service (QoS)
- **MÃ´ táº£**: Quáº£n lÃ½ vÃ  Æ°u tiÃªn lÆ°u lÆ°á»£ng máº¡ng Ä‘á»ƒ Ä‘áº£m báº£o hiá»‡u suáº¥t cho cÃ¡c á»©ng dá»¥ng quan trá»ng.
- **CÃ¡c ká»¹ thuáº­t**:
  - Traffic shaping: Giá»›i háº¡n bÄƒng thÃ´ng cho má»™t sá»‘ á»©ng dá»¥ng.
  - Packet prioritization: Æ¯u tiÃªn gÃ³i tin VoIP hoáº·c video.
- **VÃ­ dá»¥ thá»±c táº¿**: QoS trÃªn router Ä‘á»ƒ Æ°u tiÃªn bÄƒng thÃ´ng cho Zoom.

### Network Security
- **MÃ´ táº£**: Báº£o vá»‡ máº¡ng khá»i cÃ¡c má»‘i Ä‘e dá»a nhÆ° táº¥n cÃ´ng DDoS, malware, hoáº·c truy cáº­p trÃ¡i phÃ©p.
- **CÃ¡c ká»¹ thuáº­t**:
  - MÃ£ hÃ³a: Sá»­ dá»¥ng HTTPS, VPN.
  - Authentication: Sá»­ dá»¥ng giao thá»©c nhÆ° RADIUS, LDAP.
  - IDS/IPS (Intrusion Detection/Prevention System): PhÃ¡t hiá»‡n vÃ  ngÄƒn cháº·n táº¥n cÃ´ng.
- **VÃ­ dá»¥ thá»±c táº¿**: Sá»­ dá»¥ng Wireshark Ä‘á»ƒ phÃ¡t hiá»‡n lÆ°u lÆ°á»£ng Ä‘Ã¡ng nghi.

---

## Checklist há»c táº­p vÃ  nghiÃªn cá»©u

- [ ] Hiá»ƒu rÃµ mÃ´ hÃ¬nh OSI vÃ  TCP/IP, so sÃ¡nh sá»± khÃ¡c biá»‡t.
- [ ] Náº¯m vá»¯ng cÃ¡c giao thá»©c chÃ­nh: HTTP, TCP, IP, DNS, Ethernet.
- [ ] TÃ¬m hiá»ƒu cÃ¡c loáº¡i máº¡ng: LAN, WAN, VPN, PAN.
- [ ] Thá»±c hÃ nh phÃ¢n tÃ­ch gÃ³i tin báº±ng Wireshark.
- [ ] Thiáº¿t láº­p má»™t máº¡ng LAN Ä‘Æ¡n giáº£n vá»›i router vÃ  switch.
- [ ] TÃ¬m hiá»ƒu vá» báº£o máº­t máº¡ng: Firewall, VPN, IDS/IPS.
- [ ] Äá»c sÃ¡ch *Computer Networking: A Top-Down Approach* cá»§a Kurose & Ross.
- [ ] Thá»±c hÃ nh cáº¥u hÃ¬nh router vÃ  switch báº±ng Cisco Packet Tracer.
- [ ] TÃ¬m hiá»ƒu vá» IPv6 vÃ  cÃ¡ch chuyá»ƒn Ä‘á»•i tá»« IPv4.
- [ ] NghiÃªn cá»©u cÃ¡c cÃ´ng nghá»‡ máº¡ng hiá»‡n Ä‘áº¡i nhÆ° SDN (Software-Defined Networking).

---

## CÃ´ng cá»¥ Ä‘á» xuáº¥t

- **Wireshark**: PhÃ¢n tÃ­ch gÃ³i tin máº¡ng, há»— trá»£ debug vÃ  báº£o máº­t.
- **Cisco Packet Tracer**: MÃ´ phá»ng máº¡ng, lÃ½ tÆ°á»Ÿng cho há»c táº­p vÃ  thá»­ nghiá»‡m.
- **GNS3**: MÃ´ phá»ng máº¡ng phá»©c táº¡p, há»— trá»£ thiáº¿t bá»‹ thá»±c táº¿.
- **Postman**: Kiá»ƒm tra API (HTTP, REST).
- **Nmap**: QuÃ©t máº¡ng Ä‘á»ƒ phÃ¡t hiá»‡n thiáº¿t bá»‹ vÃ  cá»•ng má»Ÿ.
- **pfSense**: Pháº§n má»m firewall mÃ£ nguá»“n má»Ÿ.
- **Mininet**: MÃ´ phá»ng máº¡ng SDN.
- **Netcat**: CÃ´ng cá»¥ linh hoáº¡t Ä‘á»ƒ kiá»ƒm tra káº¿t ná»‘i máº¡ng.

---

## Kinh nghiá»‡m thá»±c hÃ nh

1. **PhÃ¢n tÃ­ch gÃ³i tin**:
   - Sá»­ dá»¥ng Wireshark Ä‘á»ƒ báº¯t vÃ  phÃ¢n tÃ­ch lÆ°u lÆ°á»£ng HTTP, DNS, TCP.
   - TÃ¬m hiá»ƒu cÃ¡ch xÃ¡c Ä‘á»‹nh cÃ¡c gÃ³i tin báº¥t thÆ°á»ng hoáº·c táº¥n cÃ´ng.

2. **Thiáº¿t láº­p máº¡ng LAN**:
   - Cáº¥u hÃ¬nh router Wi-Fi vá»›i DHCP vÃ  NAT.
   - Thiáº¿t láº­p VLAN trÃªn switch Ä‘á»ƒ tÃ¡ch biá»‡t lÆ°u lÆ°á»£ng máº¡ng.

3. **MÃ´ phá»ng máº¡ng**:
   - Sá»­ dá»¥ng Cisco Packet Tracer Ä‘á»ƒ thiáº¿t káº¿ má»™t máº¡ng doanh nghiá»‡p nhá».
   - Thá»­ nghiá»‡m Ä‘á»‹nh tuyáº¿n tÄ©nh vÃ  Ä‘á»™ng (RIP, OSPF).

4. **Báº£o máº­t máº¡ng**:
   - CÃ i Ä‘áº·t pfSense Ä‘á»ƒ cáº¥u hÃ¬nh firewall vÃ  VPN.
   - Thá»±c hÃ nh quÃ©t máº¡ng báº±ng Nmap Ä‘á»ƒ tÃ¬m lá»— há»•ng.

5. **Dá»± Ã¡n thá»±c táº¿**:
   - XÃ¢y dá»±ng má»™t há»‡ thá»‘ng giÃ¡m sÃ¡t máº¡ng sá»­ dá»¥ng Prometheus vÃ  Grafana.
   - Triá»ƒn khai má»™t VPN server sá»­ dá»¥ng OpenVPN.

---

## TÃ i liá»‡u tham kháº£o

1. **SÃ¡ch**:
   - *Computer Networking: A Top-Down Approach* bá»Ÿi James F. Kurose vÃ  Keith W. Ross.
   - *TCP/IP Illustrated, Volume 1: The Protocols* bá»Ÿi W. Richard Stevens.
   - *Network Security Essentials* bá»Ÿi William Stallings.
2. **KhÃ³a há»c trá»±c tuyáº¿n**:
   - Coursera: *Introduction to Computer Networking* bá»Ÿi Stanford University.
   - Udemy: *Cisco CCNA 200-301 Complete Course*.
3. **Website**:
   - Cisco Networking Academy: https://www.netacad.com/
   - Wireshark Documentation: https://www.wireshark.org/docs/
   - IETF (Internet Engineering Task Force): https://www.ietf.org/
4. **TÃ i nguyÃªn cá»™ng Ä‘á»“ng**:
   - Stack Overflow: CÃ¢u há»i vÃ  tráº£ lá»i vá» máº¡ng mÃ¡y tÃ­nh.
   - Reddit: r/networking, r/sysadmin.

---

> **LÆ°u Ã½**: TÃ i liá»‡u nÃ y sáº½ Ä‘Æ°á»£c cáº­p nháº­t liÃªn tá»¥c Ä‘á»ƒ bá»• sung cÃ¡c khÃ¡i niá»‡m má»›i, cÃ´ng cá»¥, vÃ  kinh nghiá»‡m thá»±c táº¿. Náº¿u báº¡n cÃ³ Ä‘á» xuáº¥t hoáº·c cáº§n thÃªm chi tiáº¿t, hÃ£y liÃªn há»‡ vá»›i **@author**!
================================================================================

--- FILE: check\crypted.md ---
# ğŸ” RADIUS, AAA, vÃ  FortiToken Resource (Advanced Security Concepts)

## 1ï¸âƒ£ Giá»›i thiá»‡u vá» RADIUS
**RADIUS (Remote Authentication Dial-In User Service)** lÃ  má»™t giao thá»©c chuáº©n **AAA** (Authentication, Authorization, Accounting).  
KhÃ¡c vá»›i LDAP, RADIUS khÃ´ng sá»­ dá»¥ng cáº¥u trÃºc cÃ¢y thÆ° má»¥c, mÃ  táº­p trung vÃ o xÃ¡c thá»±c vÃ  quáº£n lÃ½ truy cáº­p.

- **AAA bao gá»“m:**
  - **Authentication:** XÃ¡c minh danh tÃ­nh ngÆ°á»i dÃ¹ng.
  - **Authorization:** Quyá»n Ä‘Æ°á»£c phÃ©p lÃ m gÃ¬ sau khi Ä‘Äƒng nháº­p.
  - **Accounting:** Theo dÃµi, ghi log hoáº¡t Ä‘á»™ng ngÆ°á»i dÃ¹ng.

### ğŸ“¡ QuÃ¡ trÃ¬nh xÃ¡c thá»±c RADIUS
1. Client (VD: FortiGate) gá»­i **ACCESS-REQUEST** Ä‘áº¿n RADIUS server.
2. Server tráº£ vá» má»™t trong ba pháº£n há»“i:
   - **ACCESS-ACCEPT:** ThÃ´ng tin xÃ¡c thá»±c Ä‘Ãºng.
   - **ACCESS-REJECT:** ThÃ´ng tin sai.
   - **ACCESS-CHALLENGE:** YÃªu cáº§u thÃªm xÃ¡c thá»±c thá»© hai (2FA, token, chá»©ng chá»‰).
3. Má»™t sá»‘ client khÃ´ng há»— trá»£ **RADIUS Challenge**.

### âš™ï¸ Ká»¹ thuáº­t
- Giao thá»©c: UDP (Authentication: 1645/1812, Accounting: 1646/1813).
- RADIUS cÃ³ thá»ƒ má»Ÿ rá»™ng báº±ng **Vendor-Specific Attributes (VSA)**, vÃ­ dá»¥ Fortinet cÃ³ dictionary riÃªng.

---

## 2ï¸âƒ£ Cáº¥u hÃ¬nh RADIUS Server trÃªn FortiGate
- **GUI:** `User & Authentication > RADIUS Servers`
- **CLI:** `config user radius`

CÃ¡c thÃ nh pháº§n chÃ­nh:
- **Primary Server IP/Name:** IP/FQDN cá»§a RADIUS server.
- **Secret:** KhÃ³a bÃ­ máº­t chia sáº» giá»¯a FortiGate vÃ  RADIUS server.
- **Backup Servers:** Server dá»± phÃ²ng.
- **Authentication Method:** chap, pap, mschap, mschap2 (Default: pap â†’ mschap2 â†’ chap).
- **Test Connectivity:** Kiá»ƒm tra káº¿t ná»‘i Ä‘áº¿n RADIUS.
- **Test User Credentials:** Kiá»ƒm tra xÃ¡c thá»±c ngÆ°á»i dÃ¹ng.
- **Include in every User Group:** Chá»‰ báº­t trong trÆ°á»ng há»£p Ä‘áº·c biá»‡t (vÃ­ dá»¥ admin-only).

### ğŸ” Kiá»ƒm thá»­ RADIUS
- DÃ¹ng CLI:  
  ```bash
  diagnose test authserver radius <server_name> <username> <password>

================================================================================

--- FILE: check\dns_guide.md ---
# ğŸŒ DNS (Domain Name System) 

> TÃ i liá»‡u nÃ y lÃ  pháº§n ná»‘i tiáº¿p bá»™ **Network/VPN/Ports**: táº­p trung vÃ o cÃ¡ch DNS hoáº¡t Ä‘á»™ng á»Ÿ má»©c há»‡ thá»‘ng, cáº¥u trÃºc báº£n ghi, triá»ƒn khai, báº£o máº­t (DNSSEC, DoH/DoT), vÃ  troubleshooting.

---

## 1) DNS lÃ  gÃ¬? (What & Why)
**DNS** lÃ  há»‡ thá»‘ng phÃ¢n giáº£i tÃªn miá»n â†’ Ä‘á»‹a chá»‰ (thÆ°á»ng lÃ  IP), giá»‘ng nhÆ° **â€œdanh báº¡ Ä‘iá»‡n thoáº¡i cá»§a Internetâ€**.
- NgÆ°á»i dÃ¹ng gÃµ `example.com` â†’ há»‡ thá»‘ng tráº£ vá» **A/AAAA** (IPv4/IPv6).
- á»¨ng dá»¥ng/OS khÃ´ng pháº£i nhá»› IP, dá»… thay Ä‘á»•i kiáº¿n trÃºc háº¡ táº§ng mÃ  khÃ´ng lÃ m giÃ¡n Ä‘oáº¡n ngÆ°á»i dÃ¹ng.
- DNS cÃ²n lÃ m nhiá»u viá»‡c hÆ¡n: email routing (MX), service discovery (SRV), chÃ­nh sÃ¡ch báº£o máº­t/á»§y quyá»n (TXT, CAA)â€¦

**Cá»•ng & giao thá»©c máº·c Ä‘á»‹nh**
- Port **53/UDP** (truy váº¥n thÃ´ng thÆ°á»ng), **53/TCP** (truy váº¥n lá»›n/AXFR/IXFR hoáº·c khi UDP bá»‹ cháº·n/fragment).
- **DoT (DNS over TLS)**: TCP **853**.
- **DoH (DNS over HTTPS)**: **443** (qua HTTPS).
- **DoQ (DNS over QUIC)**: UDP **853** (Ä‘Æ°á»£c IANA cáº¥p phÃ¡t).

---

## 2) ThÃ nh pháº§n trong há»‡ sinh thÃ¡i DNS
- **Stub Resolver** (trÃªn OS/app): gá»Ÿi truy váº¥n Ä‘áº¿n recursive resolver.
- **Recursive Resolver** (cÃ²n gá»i â€œresolverâ€/â€œcaching resolverâ€): nháº­n truy váº¥n tá»« client, truy váº¥n tiáº¿p cÃ¡c **authoritative** vÃ  **cache** káº¿t quáº£.
- **Authoritative Nameserver**: mÃ¡y chá»§ **cÃ³ tháº©m quyá»n** cho má»™t zone (tráº£ lá»i dá»¯ liá»‡u gá»‘c).
- **Registrar**: nÆ¡i Ä‘Äƒng kÃ½ tÃªn miá»n (liÃªn káº¿t domain â†” nameserver thÃ´ng qua **NS** táº¡i registry).
- **Registry / TLD**: cÆ¡ quan quáº£n lÃ½ TLD (vÃ­ dá»¥ `.com`, `.vn`).

### Luá»“ng phÃ¢n giáº£i (Ä‘Æ¡n giáº£n hoÃ¡)
```ascii
[App/OS]
   â”‚ 1. Query: example.com A?
   â–¼
[Recursive Resolver]
   â”‚ 2. Há»i root (.) â†’ chá»‰ Ä‘áº¿n .com
   â–¼
[. Root NS]
   â”‚ 3. Há»i .com â†’ chá»‰ Ä‘áº¿n NS cá»§a example.com
   â–¼
[.com TLD NS]
   â”‚ 4. Há»i NS cá»§a zone example.com
   â–¼
[Authoritative NS for example.com]
   â”‚ 5. Tráº£ lá»i A 93.184.216.34 (kÃ¨m TTL)
   â–¼
[Recursive Resolver] (cache)
   â”‚ 6. Tráº£ vá» client (tÃ´n trá»ng TTL)
   â–¼
[App/OS]
```

---

## 3) Zone, Delegation & Glue
- **Zone**: pháº¡m vi dá»¯ liá»‡u DNS Ä‘Æ°á»£c quáº£n trá»‹ thá»‘ng nháº¥t (vÃ­ dá»¥: zone `example.com.` trong file zone).
- **Delegation**: á»§y quyá»n má»™t nhÃ¡nh con cho zone khÃ¡c (vÃ­ dá»¥: `dev.example.com` do team khÃ¡c quáº£n lÃ½).
- **Glue Record**: Khi NS cá»§a zone con dÃ¹ng **hostname náº±m trong chÃ­nh zone Ä‘Ã³**, cáº§n báº£n ghi **A/AAAA â€œkeÌ€m keoâ€** á»Ÿ zone cha Ä‘á»ƒ trÃ¡nh vÃ²ng láº·p tra cá»©u.

```ascii
Parent Zone: example.com.
  dev.example.com.  NS   ns1.dev.example.com.
  ns1.dev.example.com.  A  203.0.113.10   ; <-- glue táº¡i zone cha
```

---

## 4) CÃ¡c loáº¡i báº£n ghi (Record Types) quan trá»ng
- **A**: tÃªn â†’ IPv4
- **AAAA**: tÃªn â†’ IPv6
- **CNAME**: bÃ­ danh (alias) â†’ *canonical name*. KhÃ´ng Ä‘Æ°á»£c Ä‘áº·t CNAME á»Ÿ **apex** (gá»‘c zone), trá»« giáº£i phÃ¡p **ALIAS/ANAME** cá»§a má»™t sá»‘ DNS providers.
- **MX**: Ä‘á»‹nh tuyáº¿n email (Æ°u tiÃªn tháº¥p hÆ¡n = Æ°u tiÃªn cao hÆ¡n).
- **TXT**: Ä‘a dá»¥ng (SPF, DKIM, DMARC, domain verificationâ€¦)
- **NS**: chá»‰ Ä‘á»‹nh nameserver cÃ³ tháº©m quyá»n cho (sub)zone.
- **SOA**: thÃ´ng tin zone (serial, refresh, retry, expire, minimum/negative TTL).
- **SRV**: service discovery (vÃ­ dá»¥ `_sip._tcp.example.com`).
- **CAA**: chá»‰ Ä‘á»‹nh CA nÃ o Ä‘Æ°á»£c phÃ©p phÃ¡t hÃ nh chá»©ng chá»‰ cho domain.
- **PTR**: reverse DNS (IP â†’ tÃªn). Quáº£n lÃ½ bá»Ÿi chá»§ sá»Ÿ há»¯u block IP (thÆ°á»ng lÃ  ISP/Cloud).

VÃ­ dá»¥ **zone file** rÃºt gá»n:
```zone
$ORIGIN example.com.
$TTL 3600
@       IN SOA  ns1.example.net. hostmaster.example.com. (
            20250822 ; serial (YYYYMMDD or increment)
            7200     ; refresh
            3600     ; retry
            1209600  ; expire
            300 )    ; negative caching (min TTL/NX)

        IN NS   ns1.example.net.
        IN NS   ns2.example.net.

; Web
@       IN A    203.0.113.20
@       IN AAAA 2001:db8::20
www     IN CNAME @

; Email
@       IN MX 10 mail.example.com.
mail    IN A 203.0.113.30
_dmarc  IN TXT "v=DMARC1; p=quarantine; rua=mailto:dmarc@example.com"
@       IN TXT "v=spf1 ip4:203.0.113.30 -all"
selector1._domainkey IN TXT "v=DKIM1; k=rsa; p=MIIBI..."

; Service Discovery
_sip._tcp IN SRV 10 60 5060 sip1.example.com.
sip1     IN A 203.0.113.40

; Certificate policy
@       IN CAA 0 issue "letsencrypt.org"
```

---

## 5) Caching & TTL (vÃ  â€œPropagationâ€)
- **TTL** (Time To Live) quyáº¿t Ä‘á»‹nh thá»i gian báº£n ghi Ä‘Æ°á»£c giá»¯ trong cache cá»§a resolver/OS/browser.
- Thay Ä‘á»•i DNS **khÃ´ng â€œlanâ€ ngay láº­p tá»©c** â€“ sáº½ phá»¥ thuá»™c TTL cÃ²n láº¡i trong cache.
- **Negative Caching** (NXDOMAIN/NODATA) dÃ¹ng giÃ¡ trá»‹ trong **SOA minimum** / RFC 2308.
- Chiáº¿n lÆ°á»£c deploy: háº¡ TTL (vÃ­ dá»¥ 300s) **trÆ°á»›c** khi cáº¯t chuyá»ƒn, Ä‘á»£i TTL cÅ© háº¿t, rá»“i cáº­p nháº­t báº£n ghi.

---

## 6) Recursion Control, Forwarder, Split-Horizon
- **Open Resolver** (Ä‘á»ƒ Internet truy váº¥n tÃ¹y Ã½) â†’ **KHÃ”NG KHUYÃŠN DÃ™NG** (rá»§i ro DDoS amplification, láº¡m dá»¥ng). Chá»‰ báº­t recursion cho máº¡ng ná»™i bá»™/trusted.
- **Forwarder**: Resolver chuyá»ƒn toÃ n bá»™ truy váº¥n Ä‘áº¿n má»™t upstream (vÃ­ dá»¥ public DNS nhÆ° 1.1.1.1/8.8.8.8) Ä‘á»ƒ Ä‘Æ¡n giáº£n hoÃ¡ quáº£n trá»‹/ghi log.
- **Split-Horizon / Split-Brain DNS**: CÃ¹ng má»™t tÃªn nhÆ°ng tráº£ IP khÃ¡c nhau cho **internal** vs **public** (há»¯u Ã­ch cho hybrid cloud, zero-trust).

---

## 7) DNSSEC, DoT/DoH/DoQ & Báº£o máº­t
- **DNSSEC**: KÃ½ sá»‘ dá»¯ liá»‡u DNS Ä‘á»ƒ chá»‘ng giáº£ máº¡o (origin authentication, data integrity). Gá»“m cÃ¡c báº£n ghi **RRSIG, DNSKEY, DS, NSEC/NSEC3**.
  - Chain of trust: Root (.) â†’ TLD â†’ Domain (DS record táº¡i zone cha trá» Ä‘áº¿n DNSKEY cá»§a zone con).
  - Triá»ƒn khai cáº§n xoay **key rollover** Ä‘Ãºng quy trÃ¬nh.
- **DoT (DNS over TLS)**: MÃ£ hoÃ¡ truy váº¥n DNS qua TLS (port 853).
- **DoH (DNS over HTTPS)**: DNS qua HTTPS (port 443), dá»… vÆ°á»£t proxy/kiá»ƒm duyá»‡t, tÃ­ch há»£p trÃ¬nh duyá»‡t.
- **DoQ (DNS over QUIC)**: Äá»™ trá»… tháº¥p, trÃ¡nh head-of-line blocking (UDP 853).
- **TSIG**: KÃ½ MAC (symmetric) Ä‘á»ƒ báº£o vá»‡ **zone transfer** (AXFR/IXFR) & dynamic updates.
- **RRL/ACL**: Response Rate Limiting & Access Control Lists Ä‘á»ƒ giáº£m thiá»ƒu amplification/dga abuse.

**Amplification Attack** â€“ vÃ¬ sao?  
- Truy váº¥n nhá» â†’ Ä‘Ã¡p lá»›n (Ä‘áº·c biá»‡t vá»›i **ANY**, DNSSEC, EDNS0), káº» xáº¥u giáº£ máº¡o **source IP** cá»§a náº¡n nhÃ¢n.
- Giáº£m thiá»ƒu: táº¯t open recursion, RRL, háº¡n cháº¿ ANY, BCP-38 (ingress filtering).

---

## 8) Tooling & Troubleshooting (dig/nslookup/drill/kdig)
CÃ¡c lá»‡nh máº«u (Linux/macOS; trÃªn Windows dÃ¹ng `nslookup` hoáº·c PowerShell `Resolve-DnsName`):

```bash
# Truy váº¥n A & theo dÃµi Ä‘Æ°á»ng Ä‘i (trace tá»« root)
dig +trace example.com A

# Truy váº¥n cá»¥ thá»ƒ Ä‘áº¿n 1 NS
dig @8.8.8.8 example.com A

# MX, NS, TXT
dig example.com MX
dig example.com NS
dig example.com TXT

# Kiá»ƒm tra DNSSEC
dig example.com A +dnssec
dig example.com DS +dnssec

# Kiá»ƒm tra CAA
dig example.com CAA

# Kiá»ƒm tra reverse (PTR) cho IPv4
dig -x 203.0.113.30

# EDNS0, kÃ­ch thÆ°á»›c UDP, vÃ  fallback TCP
dig example.com A +edns=0 +bufsize=1232 +tcp

# Windows PowerShell
Resolve-DnsName example.com -Type A
Resolve-DnsName example.com -Type MX
```

**TrÆ°á»ng há»£p thÆ°á»ng gáº·p**
- â€œPropagation cháº­mâ€: do cache cÃ²n háº¡n, TTL lá»›n, resolver trung gian.
- â€œEmail khÃ´ng Ä‘áº¿nâ€: thiáº¿u/bá»‹ sai **MX/SPF/DKIM/DMARC**; PTR khÃ´ng khá»›p IP gá»­i.
- â€œKhÃ´ng trá» CNAME á»Ÿ apexâ€: dÃ¹ng **ALIAS/ANAME** cá»§a provider, hoáº·c chuyá»ƒn qua A/AAAA.
- â€œNXDOMAIN vs NODATAâ€: domain khÃ´ng tá»“n táº¡i vs tá»“n táº¡i nhÆ°ng khÃ´ng cÃ³ record query type.
- â€œGlue lá»—i thá»iâ€: thay NS/host mÃ  quÃªn cáº­p nháº­t A/AAAA tÆ°Æ¡ng á»©ng á»Ÿ zone cha.

---

## 9) Thá»±c tiá»…n tá»‘t (Best Practices)
- **Thiáº¿t káº¿ TTL há»£p lÃ½**: 300â€“3600s cho dá»‹ch vá»¥ Ä‘á»™ng; cao hÆ¡n cho báº£n ghi á»•n Ä‘á»‹nh (NS/SOA cÃ¢n nháº¯c).
- **Báº£o vá»‡ zone transfer**: chá»‰ cho phÃ©p AXFR/IXFR vá»›i secondary Ä‘Ã£ xÃ¡c thá»±c (TSIG/ACL/VPN).
- **Giáº£m táº¥n cÃ´ng**: táº¯t open recursion, báº­t RRL, lá»c ANY, theo dÃµi log.
- **Email hygiene**: triá»ƒn khai **SPF, DKIM, DMARC**, reverse PTR phÃ¹ há»£p.
- **GiÃ¡m sÃ¡t**: health-check authoritative, theo dÃµi **serial** tÄƒng Ä‘á»u (SOA).
- **Anycast authoritative/recursive** Ä‘á»ƒ tÄƒng SLA, giáº£m latency khu vá»±c.
- **IaC cho DNS**: quáº£n lÃ½ zone báº±ng GitOps/Terraform/OctoDNS Ä‘á»ƒ review/rollback dá»… dÃ ng.

---

## 10) Phá»¥ lá»¥c: SÆ¡ Ä‘á»“ tá»•ng quan
```ascii
                         +----------------------+
                         |     Root (.) NS      |
                         +----------+-----------+
                                    |
                                  (referral)
                                    |
                          +---------v----------+
                          |      .com  NS      |
                          +---------+----------+
                                    |
                                  (referral)
                                    |
                     +--------------v---------------+
                     |  Authoritative NS (example)  |
                     +--------------+---------------+
                                    |
                                 (answer)
                                    |
     +-----------+         +--------v--------+
     |  Client   |  --->   | Recursive/Caching|
     | (Stub Res)|         |    Resolver      |
     +-----------+         +------------------+
```

---

### TÃ³m táº¯t
- DNS phÃ¢n giáº£i **tÃªn â†’ dá»¯ liá»‡u** (phá»• biáº¿n nháº¥t lÃ  **IP**), dá»±a trÃªn há»‡ thá»‘ng **authoritative + caching**.
- Náº¯m cháº¯c **record types**, **TTL/cache**, **delegation/glue**, vÃ  **báº£o máº­t (DNSSEC/DoH/DoT/DoQ)** lÃ  chÃ¬a khoÃ¡ Ä‘á»ƒ váº­n hÃ nh há»‡ thá»‘ng hiá»‡n Ä‘áº¡i.

================================================================================

--- FILE: check\network_protocols_ports.md ---
# ğŸŒ Internet Protocols, Ports & Networking â€“ Resource for Developers

## 1. Internet Protocols Overview
Internet protocols are a **set of rules and conventions** that govern how data is transmitted and received over the Internet.  
They define standards for communication between devices and networks.

---

## 2. What is Protocol?
A **protocol** is a standardized set of rules that allow two or more entities in a communication system to transmit information.

Examples: HTTP, TCP, UDP, FTP, etc.

---

## 3. What is a Network Port?
A **network port** is a communication endpoint in a computer network.  
It is a **software construct** that allows devices or applications to send and receive data.

- Port numbers are **16-bit unsigned integers** â†’ range from 0 to 65,535.  
- Each port number is associated with a **specific protocol or service**.

ğŸ‘‰ Example:  
- HTTP â†’ Port 80  
- HTTPS â†’ Port 443  
- FTP â†’ Port 21  

---

## 4. Port Numbers in Action
When a communication arrives at a server:
- **IP address** identifies the host.  
- **Port number** identifies the specific service/process.

ğŸ“Œ Example:  
- FTP (Port 21) for file transfers.  
- HTTP (Port 80) for websites.  
- SMTP (Port 25) for email transfer.  

---

## 5. Why are Ports Important?
Ports allow **multiple types of traffic** to flow simultaneously without confusion.

Example:  
- Bob sends Alice an MP3 via FTP (Port 21).  
- At the same time, Alice loads a website via HTTP (Port 80).  
- Even though both streams travel over the same Wi-Fi, the OS knows which application to send the data to.

---

## 6. OSI Model & Ports
The OSI model divides Internet communication into **7 layers**.

- **Ports are part of the Transport Layer (Layer 4)**.  
- Only transport protocols (TCP, UDP) define port numbers.  
- The **Network Layer (Layer 3, e.g., IP)** is unaware of ports (only handles IP addresses).

---

## 7. OSI Model Protocols

### ğŸ”¹ Layer 1: Physical Layer
Examples: USB, Ethernet, Wi-Fi PHY, DSL, ISDN, Bluetooth

### ğŸ”¹ Layer 2: Data Link Layer
Examples: Ethernet, PPP, VLAN, STP, MAC, LACP, HDLC

### ğŸ”¹ Layer 3: Network Layer
Examples: IPv4, IPv6, ICMP, IPSec, OSPF, MPLS, NAT, RIP, BGP

### ğŸ”¹ Layer 4: Transport Layer
Examples: TCP, UDP, SCTP, DCCP

### ğŸ”¹ Layer 5: Session Layer
Examples: PPTP, SMB, RPC, NFS, PAP

### ğŸ”¹ Layer 6: Presentation Layer
Examples: TLS, SSL, AFP

### ğŸ”¹ Layer 7: Application Layer
Examples: HTTP, HTTPS, DNS, FTP, SMTP, POP3, SSH, SNMP, Telnet, BitTorrent

---

## 8. Common Ports and Services

| Port | Protocol/Service | Description | Transport |
|------|-----------------|-------------|-----------|
| 20-21 | FTP | File Transfer Protocol | TCP |
| 22 | SSH | Secure Shell (remote login, file transfer, tunneling) | TCP |
| 23 | Telnet | Remote text communication (insecure) | TCP/UDP |
| 25 | SMTP | Email transfer between servers | TCP |
| 53 | DNS | Domain Name System (hostname â†” IP) | TCP/UDP |
| 69 | TFTP | Trivial File Transfer Protocol | UDP |
| 80 | HTTP | Unencrypted web traffic | TCP |
| 110 | POP3 | Email retrieval from server | TCP/UDP |
| 123 | NTP | Network Time Protocol | UDP |
| 135 | DCE/RPC | Endpoint Mapper | TCP/UDP |
| 139 | NetBIOS | Session Service | TCP/UDP |
| 161 | SNMP | Network management protocol | TCP/UDP |
| 389 | LDAP | Directory Access Protocol | TCP/UDP |
| 443 | HTTPS | Encrypted web traffic | TCP/UDP |
| 445 | SMB | Microsoft Directory Services & file sharing | TCP/UDP |
| 465 | SMTP (Secure) | Secure mail submission | TCP |
| 514 | Syslog | Logging protocol | UDP |
| 587 | SMTP | Email submission | TCP |
| 636 | LDAPS | Secure LDAP over SSL | TCP/UDP |
| 993 | IMAP | Secure mail retrieval | TCP |
| 995 | POP3 (Secure) | Secure email download | TCP/UDP |
| 1433 | MSSQL | Microsoft SQL Server | TCP |
| 1521 | Oracle DB | Oracle Database | TCP |
| 3306 | MySQL | MySQL Database | TCP |
| 3389 | RDP | Remote Desktop Protocol | TCP |
| 5060 | SIP | Session Initiation Protocol (VoIP) | TCP/UDP |
| 6881â€“6999 | BitTorrent | Peer-to-peer sharing | TCP/UDP |

---

## 9. Security Notes on Ports
- Open ports can be **attack vectors** if not properly secured.  
- Use **firewalls** to restrict access.  
- Prefer **encrypted protocols** (e.g., HTTPS over HTTP, SFTP over FTP).  

---

## 10. Summary
- Protocols define communication rules.  
- Ports act as "doors" into a machineâ€™s services.  
- OSI Model explains where protocols & ports operate.  
- Common services map to well-known ports (0â€“1023).  

ğŸ‘‰ As a developer, understanding ports & protocols is crucial for building secure and scalable networked applications.

================================================================================

--- FILE: check\OSImodel.md ---
# ğŸ“˜ OSI Model - Full Resource (Master Level)

## ğŸ”¹ Giá»›i thiá»‡u
**OSI Model (Open Systems Interconnection Model)** lÃ  má»™t mÃ´ hÃ¬nh tham chiáº¿u gá»“m **7 táº§ng** giÃºp chuáº©n hÃ³a cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n qua máº¡ng mÃ¡y tÃ­nh. NÃ³ khÃ´ng pháº£i lÃ  má»™t giao thá»©c cá»¥ thá»ƒ, mÃ  lÃ  khung lÃ½ thuyáº¿t mÃ´ táº£ quÃ¡ trÃ¬nh truyá»n dá»¯ liá»‡u tá»« **á»©ng dá»¥ng cá»§a ngÆ°á»i gá»­i** Ä‘áº¿n **á»©ng dá»¥ng cá»§a ngÆ°á»i nháº­n**.

---

## ğŸ”¹ 7 táº§ng trong mÃ´ hÃ¬nh OSI

### 1ï¸âƒ£ Physical Layer (Táº§ng váº­t lÃ½)
- **Chá»©c nÄƒng:** Truyá»n táº£i bit (0/1) dÆ°á»›i dáº¡ng tÃ­n hiá»‡u Ä‘iá»‡n, Ã¡nh sÃ¡ng hoáº·c sÃ³ng vÃ´ tuyáº¿n qua mÃ´i trÆ°á»ng truyá»n dáº«n (cÃ¡p, sÃ³ng khÃ´ng dÃ¢y).
- **ÄÆ¡n vá»‹ dá»¯ liá»‡u:** **Bit**
- **Thiáº¿t bá»‹ liÃªn quan:** Hub, repeater, cÃ¡p quang, card máº¡ng (NIC).
- **Nhiá»‡m vá»¥ chÃ­nh:**
  - MÃ£ hÃ³a tÃ­n hiá»‡u (Encoding/Decoding).
  - Äá»‹nh nghÄ©a chuáº©n káº¿t ná»‘i váº­t lÃ½ (RJ45, USB, Bluetooth).
  - Äiá»u cháº¿ sÃ³ng (Modulation).

---

### 2ï¸âƒ£ Data Link Layer (Táº§ng liÃªn káº¿t dá»¯ liá»‡u)
- **Chá»©c nÄƒng:** ÄÃ³ng gÃ³i bit thÃ nh **frame**, kiá»ƒm soÃ¡t lá»—i vÃ  kiá»ƒm soÃ¡t truy cáº­p Ä‘Æ°á»ng truyá»n.
- **ÄÆ¡n vá»‹ dá»¯ liá»‡u:** **Frame**
- **Giao thá»©c/chuáº©n:** Ethernet, PPP, HDLC, Wi-Fi (IEEE 802.11).
- **Nhiá»‡m vá»¥ chÃ­nh:**
  - **MAC (Media Access Control):** Quáº£n lÃ½ truy cáº­p Ä‘Æ°á»ng truyá»n, Ä‘á»‹a chá»‰ MAC.
  - **LLC (Logical Link Control):** Kiá»ƒm tra lá»—i (CRC), kiá»ƒm soÃ¡t luá»“ng dá»¯ liá»‡u.
- **Thiáº¿t bá»‹ liÃªn quan:** Switch, Bridge.

---

### 3ï¸âƒ£ Network Layer (Táº§ng máº¡ng)
- **Chá»©c nÄƒng:** XÃ¡c Ä‘á»‹nh Ä‘Æ°á»ng Ä‘i (routing) cho gÃ³i tin tá»« nguá»“n â†’ Ä‘Ã­ch.
- **ÄÆ¡n vá»‹ dá»¯ liá»‡u:** **Packet**
- **Giao thá»©c:** IPv4, IPv6, ICMP, IPsec.
- **Nhiá»‡m vá»¥ chÃ­nh:**
  - Äá»‹nh tuyáº¿n (Routing).
  - Äá»‹a chá»‰ hÃ³a (Addressing â€“ IP address).
  - PhÃ¢n máº£nh & láº¯p ghÃ©p gÃ³i tin.
- **Thiáº¿t bá»‹ liÃªn quan:** Router, Layer 3 Switch.

---

### 4ï¸âƒ£ Transport Layer (Táº§ng giao váº­n)
- **Chá»©c nÄƒng:** Äáº£m báº£o dá»¯ liá»‡u truyá»n táº£i tin cáº­y giá»¯a hai á»©ng dá»¥ng.
- **ÄÆ¡n vá»‹ dá»¯ liá»‡u:** **Segment (TCP)** / **Datagram (UDP)**
- **Giao thá»©c chÃ­nh:**
  - **TCP (Transmission Control Protocol):** Tin cáº­y, cÃ³ xÃ¡c nháº­n (ACK), kiá»ƒm soÃ¡t luá»“ng, phá»¥c há»“i lá»—i.
  - **UDP (User Datagram Protocol):** Nhanh, khÃ´ng cáº§n xÃ¡c nháº­n, dÃ¹ng cho video/voice streaming, DNS.
- **Nhiá»‡m vá»¥ chÃ­nh:**
  - PhÃ¢n máº£nh vÃ  tÃ¡i láº¯p dá»¯ liá»‡u (Segmentation & Reassembly).
  - Quáº£n lÃ½ cá»•ng (Port numbers).

---

### 5ï¸âƒ£ Session Layer (Táº§ng phiÃªn)
- **Chá»©c nÄƒng:** Quáº£n lÃ½ **phiÃªn giao tiáº¿p (session)** giá»¯a hai á»©ng dá»¥ng.
- **Nhiá»‡m vá»¥ chÃ­nh:**
  - Thiáº¿t láº­p, duy trÃ¬, káº¿t thÃºc phiÃªn lÃ m viá»‡c.
  - Äá»“ng bá»™ hÃ³a dá»¯ liá»‡u (Checkpoint/Recovery).
  - **Authentication & Authorization** (XÃ¡c thá»±c & phÃ¢n quyá»n).
- **VÃ­ dá»¥ thá»±c táº¿:** TrÃ¬nh duyá»‡t quáº£n lÃ½ session khi Ä‘Äƒng nháº­p website.

---

### 6ï¸âƒ£ Presentation Layer (Táº§ng trÃ¬nh diá»…n)
- **Chá»©c nÄƒng:** Äáº£m báº£o dá»¯ liá»‡u cÃ³ Ä‘á»‹nh dáº¡ng phÃ¹ há»£p giá»¯a hai há»‡ thá»‘ng.
- **Nhiá»‡m vá»¥ chÃ­nh:**
  - **Data Translation:** Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u (EBCDIC â†” ASCII, JPEG â†” PNG).
  - **Data Compression:** Giáº£m kÃ­ch thÆ°á»›c dá»¯ liá»‡u (Lossy/Lossless).
  - **Data Encryption/Decryption:** Báº£o máº­t dá»¯ liá»‡u khi truyá»n.
- **VÃ­ dá»¥ thá»±c táº¿:** SSL/TLS (HTTPS).

---

### 7ï¸âƒ£ Application Layer (Táº§ng á»©ng dá»¥ng)
- **Chá»©c nÄƒng:** Táº§ng gáº§n ngÆ°á»i dÃ¹ng nháº¥t, cung cáº¥p dá»‹ch vá»¥ máº¡ng trá»±c tiáº¿p cho á»©ng dá»¥ng.
- **Giao thá»©c tiÃªu biá»ƒu:**
  - **HTTP/HTTPS** â€“ Web.
  - **FTP** â€“ Truyá»n file.
  - **SMTP/IMAP/POP3** â€“ Email.
  - **DNS** â€“ PhÃ¢n giáº£i tÃªn miá»n.
  - **Telnet/SSH** â€“ Remote access.
- **VÃ­ dá»¥:** Chrome, Firefox, Outlook, Zalo, Discord.

---

## ğŸ”¹ CÃ¡ch dá»¯ liá»‡u Ä‘i qua cÃ¡c táº§ng (Encapsulation & Decapsulation)
1. á»¨ng dá»¥ng táº¡o **Data** táº¡i Application Layer.
2. Presentation Layer **mÃ£ hÃ³a/nÃ©n** dá»¯ liá»‡u.
3. Session Layer **quáº£n lÃ½ phiÃªn**.
4. Transport Layer chia dá»¯ liá»‡u thÃ nh **Segment (TCP)** hoáº·c **Datagram (UDP)**.
5. Network Layer Ä‘Ã³ng gÃ³i thÃ nh **Packet** vá»›i Ä‘á»‹a chá»‰ IP.
6. Data Link Layer Ä‘Ã³ng gÃ³i thÃ nh **Frame** vá»›i Ä‘á»‹a chá»‰ MAC.
7. Physical Layer truyá»n Ä‘i dÆ°á»›i dáº¡ng **Bit (0/1)** qua cÃ¡p hoáº·c sÃ³ng.

NgÆ°á»£c láº¡i, bÃªn nháº­n sáº½ **decapsulation** theo chiá»u ngÆ°á»£c láº¡i.

---

## ğŸ”¹ OSI vs TCP/IP Model
- **TCP/IP Model** cÃ³ 4 táº§ng: Application, Transport, Internet, Network Access.
- OSI chi tiáº¿t hÆ¡n vá»›i 7 táº§ng.
- TrÃªn thá»±c táº¿, TCP/IP lÃ  mÃ´ hÃ¬nh triá»ƒn khai chÃ­nh trong Internet.

---

## ğŸ”¹ CÃ¡c khÃ¡i niá»‡m liÃªn quan cáº§n biáº¿t
- **Encapsulation / Decapsulation:** QuÃ¡ trÃ¬nh gÃ³i vÃ  má»Ÿ gÃ³i dá»¯ liá»‡u qua cÃ¡c táº§ng.
- **Protocol Data Unit (PDU):**
  - Application â†’ Data
  - Transport â†’ Segment/Datagram
  - Network â†’ Packet
  - Data Link â†’ Frame
  - Physical â†’ Bit
- **Port Number:** Äá»‹nh danh dá»‹ch vá»¥ (HTTP: 80, HTTPS: 443, FTP: 21).
- **Sá»± khÃ¡c biá»‡t TCP & UDP:**
  - TCP = Reliable, Connection-oriented.
  - UDP = Fast, Connectionless.

---

## ğŸ”¹ TÃ³m táº¯t OSI theo cÃ¡ch dá»… nhá»›
| Táº§ng | Chá»©c nÄƒng chÃ­nh | ÄÆ¡n vá»‹ dá»¯ liá»‡u | VÃ­ dá»¥ |
|------|-----------------|----------------|-------|
| 7. Application | Giao diá»‡n cho ngÆ°á»i dÃ¹ng | Data | HTTP, FTP |
| 6. Presentation | Dá»‹ch, mÃ£ hÃ³a, nÃ©n dá»¯ liá»‡u | Data | SSL, JPEG |
| 5. Session | Quáº£n lÃ½ phiÃªn, Ä‘á»“ng bá»™ | Data | NetBIOS, RPC |
| 4. Transport | Truyá»n dá»¯ liá»‡u tin cáº­y | Segment/Datagram | TCP, UDP |
| 3. Network | Äá»‹nh tuyáº¿n, Ä‘á»‹a chá»‰ IP | Packet | IP, ICMP |
| 2. Data Link | ÄÃ³ng gÃ³i frame, kiá»ƒm soÃ¡t lá»—i | Frame | Ethernet, Wi-Fi |
| 1. Physical | Truyá»n bit qua mÃ´i trÆ°á»ng | Bit | CÃ¡p, Hub |

---

## ğŸ”¹ Káº¿t luáº­n
MÃ´ hÃ¬nh OSI lÃ  ná»n táº£ng quan trá»ng Ä‘á»ƒ hiá»ƒu cÃ¡ch dá»¯ liá»‡u di chuyá»ƒn trong máº¡ng mÃ¡y tÃ­nh. Náº¯m rÃµ tá»«ng táº§ng giÃºp ta:
- Thiáº¿t káº¿ há»‡ thá»‘ng máº¡ng.
- PhÃ¢n tÃ­ch lá»—i máº¡ng (troubleshooting).
- Hiá»ƒu sÃ¢u hÆ¡n vá» giao thá»©c vÃ  báº£o máº­t.

---
ğŸ“Œ **Tip nhá»› nhanh thá»© tá»± cÃ¡c táº§ng OSI (7 â†’ 1):**
> **A**ll **P**eople **S**eem **T**o **N**eed **D**ata **P**rocessing  
(Application â€“ Presentation â€“ Session â€“ Transport â€“ Network â€“ Data Link â€“ Physical)

================================================================================

--- FILE: check\OSI_ZTA_AAA_Handbook.md ---
# ğŸ“š Networking & Security Master Handbook
**(OSI + AAA/RADIUS + FortiToken + Zero Trust Architecture theo NIST SP 1800â€‘35B)**  
PhiÃªn báº£n: 2025â€‘08â€‘22

---

## Má»¥c lá»¥c
1. [Tá»•ng quan & Má»¥c tiÃªu há»c](#tong-quan--muc-tieu-hoc)
2. [MÃ´ hÃ¬nh OSI (7 táº§ng) â€“ Chi tiáº¿t & Thá»±c tiá»…n](#mo-hinh-osi-7-tang--chi-tiet--thuc-tien)
   - 2.1 [SÆ¡ Ä‘á»“ nhanh](#21-so-do-nhanh)
   - 2.2 [Chá»©c nÄƒng tá»«ng táº§ng](#22-chuc-nang-tung-tang)
   - 2.3 [Encapsulation/Decapsulation](#23-encapsulationdecapsulation)
   - 2.4 [PDU, thiáº¿t bá»‹, vÃ­ dá»¥ giao thá»©c](#24-pdu-thiet-bi-vi-du-giao-thuc)
   - 2.5 [OSI vs TCP/IP](#25-osi-vs-tcpip)
   - 2.6 [Troubleshooting theo lá»›p](#26-troubleshooting-theo-lop)
3. [Transport chuyÃªn sÃ¢u: TCP & UDP](#transport-chuyen-sau-tcp--udp)
4. [AAA & RADIUS & FortiToken (2FA/MFA)](#aaa--radius--fortitoken-2famfa)
   - 4.1 [AAA lÃ  gÃ¬](#41-aaa-la-gi)
   - 4.2 [RADIUS cÄƒn báº£n](#42-radius-can-ban)
   - 4.3 [RADIUS trÃªn FortiGate â€“ Cáº¥u hÃ¬nh & Kiá»ƒm thá»­](#43-radius-tren-fortigate--cau-hinh--kiem-thu)
   - 4.4 [Hai yáº¿u tá»‘ xÃ¡c thá»±c & OTP/FortiToken](#44-hai-yeu-to-xac-thuc--otpfortitoken)
5. [Zero Trust Architecture (ZTA) â€“ NIST SP 1800â€‘35B](#zero-trust-architecture-zta--nist-sp-1800-35b)
   - 5.1 [Collaborators & CRADA](#51-collaborators--crada)
   - 5.2 [Document Conventions & Call for Patent Claims](#52-document-conventions--call-for-patent-claims)
   - 5.3 [Tá»•ng quan kiáº¿n trÃºc tham chiáº¿u ZTA](#53-tong-quan-kien-truc-tham-chieu-zta)
   - 5.4 [ThÃ nh pháº§n cá»‘t lÃµi ZTA](#54-thanh-phan-cot-loi-zta)
   - 5.5 [ThÃ nh pháº§n há»— trá»£ & ngá»¯ cáº£nh](#55-thanh-phan-ho-tro--ngu-canh)
   - 5.6 [Luá»“ng hoáº¡t Ä‘á»™ng ZTA Ä‘iá»ƒn hÃ¬nh](#56-luong-hoat-dong-zta-dien-hinh)
   - 5.7 [CÃ¡c pha triá»ƒn khai (Crawl â†’ Walk â†’ Run)](#57-cac-pha-trien-khai-crawl--walk--run)
   - 5.8 [Kiáº¿n trÃºc phÃ²ng lab & ká»‹ch báº£n doanh nghiá»‡p](#58-kien-truc-phong-lab--kich-ban-doanh-nghiep)
   - 5.9 [NÄƒng lá»±c tiÃªu biá»ƒu cá»§a vendor](#59-nang-luc-tieu-bieu-cua-vendor)
6. [Phá»¥ lá»¥c A â€“ Báº£ng tá»« viáº¿t táº¯t](#phu-luc-a--bang-tu-viet-tat)
7. [Phá»¥ lá»¥c B â€“ Thuáº­t ngá»¯ nhanh](#phu-luc-b--thuat-ngu-nhanh)
8. [Phá»¥ lá»¥c C â€“ Máº«u cáº¥u hÃ¬nh & lá»‡nh kiá»ƒm thá»­](#phu-luc-c--mau-cau-hinh--lenh-kiem-thu)
9. [Phá»¥ lá»¥c D â€“ Tip ghi nhá»› & lá»™ trÃ¬nh Ã´n táº­p](#phu-luc-d--tip-ghi-nho--lo-trinh-on-tap)

---

## Tá»•ng quan & Má»¥c tiÃªu há»c
TÃ i liá»‡u nÃ y gá»™p **ba máº£ng trá»ng tÃ¢m** Ä‘á»ƒ há»c/Ã´n táº­p liá»n máº¡ch:
- **OSI Model (7 táº§ng):** ná»n táº£ng phÃ¢n tÃ­ch máº¡ng, mapping giao thá»©c, mÃ´ hÃ¬nh hÃ³a dá»¯ liá»‡u.
- **AAA/RADIUS/FortiToken:** xÃ¡c thá»±c, phÃ¢n quyá»n, ghi nháº­t kÃ½; cáº¥u hÃ¬nh FortiGate & OTP.
- **Zero Trust Architecture (NIST SP 1800â€‘35B):** kiáº¿n trÃºc tham chiáº¿u, thÃ nh pháº§n, quy trÃ¬nh, vendor.

**Báº¡n sáº½ náº¯m Ä‘Æ°á»£c:**
- CÃ¡ch dá»¯ liá»‡u Ä‘i qua cÃ¡c táº§ng (encapsulation) & phÆ°Æ¡ng phÃ¡p khoanh lá»—i theo lá»›p.
- Thiáº¿t káº¿/Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch **AAA** vÃ  triá»ƒn khai **2FA/MFA** vá»›i **FortiToken**.
- XÃ¢y dá»±ng tÆ° duy **Zero Trust** (khÃ´ng máº·c Ä‘á»‹nh tin tÆ°á»Ÿng; xÃ¡c minh liÃªn tá»¥c; least privilege).

---

## MÃ´ hÃ¬nh OSI (7 táº§ng) â€“ Chi tiáº¿t & Thá»±c tiá»…n

### 2.1 SÆ¡ Ä‘á»“ nhanh
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 7. Application  (HTTP, DNS, SMTP, FTP, SSH...)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 6. Presentation (TLS/SSL, nÃ©n, mÃ£ hÃ³a, chuyá»ƒn mÃ£)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 5. Session      (thiáº¿t láº­p/duy trÃ¬/káº¿t thÃºc phiÃªn)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 4. Transport    (TCP/UDP, cá»•ng, kiá»ƒm soÃ¡t luá»“ng)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 3. Network      (IP, routing, ICMP, IPsec)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 2. Data Link    (Ethernet, Wiâ€‘Fi, MAC, VLAN, CRC)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 1. Physical     (bit, tÃ­n hiá»‡u, cÃ¡p/sÃ³ng, encoding)
```

### 2.2 Chá»©c nÄƒng tá»«ng táº§ng
**1) Physical** â€“ Truyá»n bit (0/1) dÆ°á»›i dáº¡ng tÃ­n hiá»‡u (Ä‘iá»‡n/quang/vÃ´ tuyáº¿n). Chuáº©n Ä‘áº§u ná»‘i, tá»‘c Ä‘á»™, modulation, encoding.  
**2) Data Link** â€“ ÄÃ³ng gÃ³i **frame**, Ä‘á»‹a chá»‰ **MAC**, Ä‘iá»u khiá»ƒn truy cáº­p mÃ´i trÆ°á»ng (MAC), phÃ¡t hiá»‡n lá»—i (FCS/CRC), VLAN (802.1Q). Thiáº¿t bá»‹: **Switch/Bridge**.  
**3) Network** â€“ Äá»‹nh tuyáº¿n **packet**, Ä‘á»‹a chá»‰ IP, phÃ¢n máº£nh/láº¯p ghÃ©p, ICMP. Thiáº¿t bá»‹: **Router/L3 Switch**.  
**4) Transport** â€“ Truyá»n **endâ€‘toâ€‘end** tin cáº­y (TCP) hoáº·c nhanh, khÃ´ng Ä‘áº£m báº£o (UDP). Cá»•ng, phÃ¢n máº£nh/tÃ¡i láº¯p, kiá»ƒm soÃ¡t luá»“ng/táº¯c ngháº½n.  
**5) Session** â€“ Thiáº¿t láº­p/duy trÃ¬/káº¿t thÃºc **phiÃªn**; Ä‘á»“ng bá»™ checkpoint; **authn/authz** theo má»™t sá»‘ mÃ´ hÃ¬nh.  
**6) Presentation** â€“ **Chuyá»ƒn mÃ£**, **nÃ©n**, **mÃ£ hÃ³a/giáº£i mÃ£** (TLS/SSL).  
**7) Application** â€“ Giao diá»‡n dá»‹ch vá»¥ máº¡ng (HTTP/HTTPS, DNS, SMTP/IMAP/POP3, FTP, Telnet/SSH...).

### 2.3 Encapsulation/Decapsulation
- App táº¡o **Data** â†’ Transport táº¡o **Segment/Datagram** (thÃªm TCP/UDP header)  
â†’ Network táº¡o **Packet** (thÃªm IP header)  
â†’ Data Link táº¡o **Frame** (thÃªm MAC header/trailer)  
â†’ Physical truyá»n **Bit**.  
- BÃªn nháº­n má»Ÿ gÃ³i theo chiá»u ngÆ°á»£c láº¡i.

### 2.4 PDU, thiáº¿t bá»‹, vÃ­ dá»¥ giao thá»©c
| Lá»›p | PDU       | Thiáº¿t bá»‹ chÃ­nh        | VÃ­ dá»¥ giao thá»©c/chuáº©n |
|-----|-----------|-----------------------|-----------------------|
| 7   | Data      | App/Agent             | HTTP, HTTPS, DNS, SMTP, FTP, SSH |
| 6   | Data      | TLS library           | TLS/SSL, JPEG/PNG, ASN.1 |
| 5   | Data      | API, RPC              | RPC, NetBIOS session |
| 4   | Segment/Datagram | Host OS Stack   | TCP, UDP |
| 3   | Packet    | Router/L3 Switch      | IPv4/IPv6, ICMP, IPsec |
| 2   | Frame     | Switch/Bridge         | Ethernet 802.3, Wiâ€‘Fi 802.11, 802.1Q |
| 1   | Bit       | NIC, Hub, Repeater    | UTP/FO, 1000BASEâ€‘T, OFDM |

### 2.5 OSI vs TCP/IP
- **TCP/IP (4 lá»›p):** Application | Transport | Internet | Network Access.  
- Thá»±c táº¿ Internet cháº¡y theo TCP/IP, **OSI** dÃ¹ng Ä‘á»ƒ **há»c & phÃ¢n tÃ­ch lá»—i** chi tiáº¿t.

### 2.6 Troubleshooting theo lá»›p (máº«u cÃ¢u há»i nhanh)
1. Physical: Link up chÆ°a? cÃ¡p Ä‘Ãºng? tá»‘c Ä‘á»™/duplex?  
2. Data Link: MAC/VLAN Ä‘Ãºng? STP/portâ€‘security? CRC tÄƒng?  
3. Network: IP/subnet/gateway? route? ICMP ping/traceroute?  
4. Transport: Port má»Ÿ? TCP handshake? window/timeout?  
5â€“7. á»¨ng dá»¥ng: DNS resolve? HTTP status? TLS certificate?

---

## Transport chuyÃªn sÃ¢u: TCP & UDP
**TCP**: Káº¿t ná»‘i tin cáº­y (3â€‘way handshake), **ACK**, **retransmission**, **flow control** (window), **congestion control** (slow start, AIMD), **ordering** (sequence). Cá»: SYN, ACK, FIN, RST, PSH, URG.  
**UDP**: KhÃ´ng káº¿t ná»‘i, tá»‘i thiá»ƒu overhead, latency tháº¥p (VoIP, video, DNS).  
**Cá»•ng:** wellâ€‘known (0â€“1023), registered (1024â€“49151), dynamic/ephemeral (49152â€“65535).

**Máº¹o kiá»ƒm tra TCP:** `SYN â†’ SYN/ACK â†’ ACK`; xem RTT, MSS, window scaling, retransmissions.  
**Máº¹o kiá»ƒm tra UDP:** kiá»ƒm tra loss/jitter, MTU/fragment, timeout á»©ng dá»¥ng.

---

## AAA & RADIUS & FortiToken (2FA/MFA)

### 4.1 AAA lÃ  gÃ¬
- **Authentication (AuthN):** XÃ¡c minh danh tÃ­nh.  
- **Authorization (AuthZ):** PhÃ¢n quyá»n sau khi xÃ¡c minh.  
- **Accounting (Acct):** Ghi nháº­t kÃ½ sá»­ dá»¥ng, phá»¥c vá»¥ audit/billing.

### 4.2 RADIUS cÄƒn báº£n
- Giao thá»©c AAA chuáº©n, **UDP**: Auth **1812** (hoáº·c lá»‹ch sá»­ **1645**), Acct **1813** (hoáº·c **1646**).  
- GÃ³i xÃ¡c thá»±c Ä‘iá»ƒn hÃ¬nh tá»« client (VD: **FortiGate**) gá»­i **ACCESSâ€‘REQUEST** â†’ server pháº£n há»“i:  
  - **ACCESSâ€‘ACCEPT** (Ä‘Ãºng), **ACCESSâ€‘REJECT** (sai), **ACCESSâ€‘CHALLENGE** (yÃªu cáº§u yáº¿u tá»‘ thá»© hai/token/chá»©ng chá»‰).  
- KhÃ´ng pháº£i má»i RADIUS client Ä‘á»u há»— trá»£ **Challenge**.  
- Há»— trá»£ nhiá»u phÆ°Æ¡ng phÃ¡p: **PAP, CHAP, MSâ€‘CHAPv2** (vÃ  cÃ¡c phÆ°Æ¡ng thá»©c **EAP** qua RADIUS).  
- **VSA (Vendorâ€‘Specific Attributes):** má»Ÿ rá»™ng thuá»™c tÃ­nh riÃªng, Fortinet cÃ³ **dictionary** riÃªng.

### 4.3 RADIUS trÃªn FortiGate â€“ Cáº¥u hÃ¬nh & Kiá»ƒm thá»­
**GUI:** *User & Authentication â†’ RADIUS Servers*  
**CLI:** `config user radius`  

ThÃ´ng sá»‘ chÃ­nh:
- **Primary Server IP/Name** (IP/FQDN mÃ¡y chá»§ RADIUS).  
- **Secret** (khÃ³a chia sáº»), cÃ³ thá»ƒ cáº¥u hÃ¬nh **backup servers** (má»—i server cÃ³ secret riÃªng).  
- **Authentication Method:** `chap`, `pap`, `mschap`, `mschap2`; `default` = `pap â†’ mschap2 â†’ chap`.  
- **Test Connectivity**: chá»‰ kiá»ƒm tra káº¿t ná»‘i tá»›i server.  
- **Test User Credentials**: kiá»ƒm thá»­ Ä‘Äƒng nháº­p ngÆ°á»i dÃ¹ng.  
- **Include in every User Group**: chá»‰ báº­t trong trÆ°á»ng há»£p ráº¥t Ä‘áº·c biá»‡t (vÃ­ dá»¥ chá»‰ admin).  
- FortiGate pháº£i Ä‘Æ°á»£c khai bÃ¡o **client** trÃªn mÃ¡y chá»§ RADIUS, náº¿u khÃ´ng server sáº½ **khÃ´ng tráº£ lá»i**.

**Kiá»ƒm thá»­ CLI:**
```bash
# Kiá»ƒm tra káº¿t ná»‘i/xÃ¡c thá»±c vá»›i RADIUS (vÃ­ dá»¥)
diagnose test authserver radius <server_name> <username> <password>
# Káº¿t quáº£ sáº½ tráº£: success / failure / group membership
```

### 4.4 Hai yáº¿u tá»‘ xÃ¡c thá»±c & OTP/FortiToken
- **2FA**: Password (biáº¿t) + Token/OTP (cÃ³). CÃ³ thá»ƒ thÃªm **biometrics** (lÃ ).  
- **OTP**: mÃ£ sá»‘ng ngáº¯n (thÆ°á»ng 60s), dÃ¹ng má»™t láº§n â†’ bá»‹ cháº·n báº¯t cÅ©ng vÃ´ dá»¥ng sau khi dÃ¹ng.  
- **Deliver OTP**: **FortiToken 200 (hard token)**, **FortiToken Mobile (app)**, **email/SMS**, **Mobile Push**.  
- **Äá»“ng bá»™ thá»i gian:** nÃªn dÃ¹ng **NTP** Ä‘á»ƒ token vÃ  FortiGate khá»›p giá».  
- **FortiToken quáº£n trá»‹:**
  - **Hard Token**: serial cung cáº¥p seed ban Ä‘áº§u. CÃ³ thá»ƒ import danh sÃ¡ch serial.  
  - **Soft Token**: cáº§n activation code; má»—i FortiGate/FGTâ€‘VM thÆ°á»ng cÃ³ **2** kÃ­ch hoáº¡t miá»…n phÃ­, thÃªm cáº§n mua.  
  - **Oneâ€‘toâ€‘One**: Má»™t token chá»‰ Ä‘Äƒng kÃ½ cho **má»™t** FortiGate/FortiAuthenticator. DÃ¹ng nhiá»u thiáº¿t bá»‹ â†’ trung tÃ¢m xÃ¡c thá»±c **FortiAuthenticator**.  
- **LÆ°u Ã½:** KhÃ´ng dÃ¹ng 2FA vá»›i **explicit proxy** trÃªn FortiGate.

**Quy trÃ¬nh MFA trÃªn FortiGate (tÃ³m táº¯t):**
1. NgÆ°á»i dÃ¹ng truy cáº­p tÃ i nguyÃªn.  
2. Traffic khá»›p security policy yÃªu cáº§u auth.  
3. Nháº­p username/password â†’ FortiOS xÃ¡c minh.  
4. FortiOS yÃªu cáº§u OTP (hoáº·c push).  
5. NgÆ°á»i dÃ¹ng nháº­p mÃ£/accept push.  
6. FortiOS xÃ¡c minh OTP â†’ cáº¥p quyá»n truy cáº­p (theo policy/nhÃ³m).

---

## Zero Trust Architecture (ZTA) â€“ NIST SP 1800â€‘35B

### 5.1 Collaborators & CRADA
- Dá»± Ã¡n ZTA cá»§a NIST kÃªu gá»i cÃ¡c **Technology Partners/Collaborators** (Appgate, AWS, Broadcom, Cisco, DigiCert, F5, Forescout, Google Cloud, IBM, Ivanti, Lookout, Mandiant, Microsoft, Okta, Palo Alto Networks, PC Matic, Ping Identity, Radiant Logic, SailPoint, Tenable, Trellix, VMware, Zimperium, Zscalerâ€¦).  
- CÃ¡c bÃªn tham gia thÃ´ng qua **CRADA** Ä‘á»ƒ Ä‘Ã³ng gÃ³p sáº£n pháº©m/kháº£ nÄƒng vÃ o cÃ¡c **build** trong lab.

### 5.2 Document Conventions & Call for Patent Claims
- **shall/shall not**: yÃªu cáº§u **báº¯t buá»™c**; **should/should not**: **khuyáº¿n nghá»‹**; **may/need not**: **tÃ¹y chá»n**; **can/cannot**: **kháº£ nÄƒng**.  
- NIST má»i gá»i cÃ´ng bá»‘ **báº±ng sÃ¡ng cháº¿ thiáº¿t yáº¿u** (náº¿u cÃ³) vÃ /hoáº·c cam káº¿t **cáº¥p phÃ©p cÃ´ng báº±ng, khÃ´ng phÃ¢n biá»‡t**, hoáº·c **khÃ´ng bá»“i hoÃ n** nháº±m báº£o Ä‘áº£m kháº£ nÄƒng Ã¡p dá»¥ng rá»™ng rÃ£i.

### 5.3 Tá»•ng quan kiáº¿n trÃºc tham chiáº¿u ZTA
**TÆ° tÆ°á»Ÿng cá»‘t lÃµi:** â€œKhÃ´ng máº·c Ä‘á»‹nh tin tÆ°á»Ÿng gÃ¬ cáº£â€”**luÃ´n xÃ¡c minh** dá»±a trÃªn **ngá»¯ cáº£nh** vÃ  **chÃ­nh sÃ¡ch**; cáº¥p quyá»n **tá»‘i thiá»ƒu**; **giÃ¡m sÃ¡t liÃªn tá»¥c**.â€

**Minh há»a khÃ¡i quÃ¡t:**
```
[ Subject ] --request--> [ PEP ] --attr/telemetry--> [ PA ] --policy--> [ PE ]
     |                                           ^                      |
     |---- posture ----- [ Device Security ]     |                      |
     |---- identity ---- [ IdP / ICAM ] ---------+                      |
     |---- context ----- [ SIEM/EDR/MDM/CDM ] --------------------------+
                                     |
                                 [ Data/Resource ]
Legend: PEP=Policy Enforcement Point, PA=Policy Administrator, PE=Policy Engine
```

### 5.4 ThÃ nh pháº§n cá»‘t lÃµi ZTA
- **Policy Engine (PE):** NÆ¡i â€œra quyáº¿t Ä‘á»‹nhâ€ cáº¥p quyá»n dá»±a trÃªn chÃ­nh sÃ¡ch, thuá»™c tÃ­nh, rá»§i ro, posture.  
- **Policy Administrator (PA):** Biáº¿n quyáº¿t Ä‘á»‹nh thÃ nh lá»‡nh cáº¥u hÃ¬nh cho **Policy Enforcement Point**.  
- **Policy Enforcement Point (PEP):** Thá»±c thi quyáº¿t Ä‘á»‹nh (cho phÃ©p/cháº·n/giá»›i háº¡n), thÆ°á»ng náº±m sÃ¡t tÃ i nguyÃªn hoáº·c á»Ÿ edge.  
- **ID, Credential, and Access Management (ICAM):** Nháº­n diá»‡n, xÃ¡c thá»±c, quáº£n trá»‹ vÃ²ng Ä‘á»i danh tÃ­nh/thuá»™c tÃ­nh.  
- **Posture/Telemetry:** EDR/MDM/SIEM/NDR cung cáº¥p ngá»¯ cáº£nh (rá»§i ro, tuÃ¢n thá»§, tÃ­nh toÃ n váº¹n thiáº¿t bá»‹).  
- **Data/Applications/Services:** TÃ i nguyÃªn má»¥c tiÃªu (onâ€‘prem, cloud, SaaS, OT/IoT).

**NguyÃªn táº¯c chÃ­nh sÃ¡ch:** **ABAC** (Attributeâ€‘Based Access Control) + **riskâ€‘based** + **continuous evaluation** (liÃªn tá»¥c tÃ¡i tháº©m Ä‘á»‹nh).

### 5.5 ThÃ nh pháº§n há»— trá»£ & ngá»¯ cáº£nh
- **Device Security:** EDR, MDM, mÃ£ hÃ³a Ä‘Ä©a, kiá»ƒm tra jailbreak/root, patch level.  
- **Network Security:** Microâ€‘segmentation, SDâ€‘WAN/SASE, TLS inspection (theo chÃ­nh sÃ¡ch), DNS security.  
- **Data Security:** DLP, encryption, tokenization, classification/labeling.  
- **Observability & Ops:** SIEM, SOAR, UEBA, CMDB, threat intel, CDM.  
- **Key Management/PKI:** CA, certificate lifecycle (DigiCert,...).

### 5.6 Luá»“ng hoáº¡t Ä‘á»™ng ZTA Ä‘iá»ƒn hÃ¬nh
1. **Request**: Subject (user/app/service account) yÃªu cáº§u truy cáº­p má»™t **resource**.  
2. **Collect**: PEP/PA/PE thu tháº­p **thuá»™c tÃ­nh** (subject, device, location, time, risk score, data sensitivityâ€¦).  
3. **Decide**: PE Ä‘Ã¡nh giÃ¡ chÃ­nh sÃ¡ch (ABAC/SoD/least privilege) + **trust algorithm**.  
4. **Enforce**: PA Ä‘áº©y quyáº¿t Ä‘á»‹nh xuá»‘ng PEP (allow/deny/stepâ€‘up auth/quarantine/limited access).  
5. **Monitor & Reâ€‘Evaluate**: Telemetry thay Ä‘á»•i â†’ reâ€‘auth/reâ€‘policy (liÃªn tá»¥c).

### 5.7 CÃ¡c pha triá»ƒn khai (Crawl â†’ Walk â†’ Run)
- **Crawl**: Kiá»ƒm kÃª tÃ i nguyÃªn/danh tÃ­nh, dá»±ng **ICAM**, xÃ¡c Ä‘á»‹nh **chÃ­nh sÃ¡ch cÄƒn báº£n**, káº¿t ná»‘i nguá»“n thuá»™c tÃ­nh.  
- **Walk**: Thá»­ nghiá»‡m theo **use case** (á»©ng dá»¥ng trá»ng yáº¿u), tÃ­ch há»£p posture/EDR/MDM, báº¯t Ä‘áº§u **microâ€‘segmentation**.  
- **Run**: Má»Ÿ rá»™ng tá»• chá»©c, **continuous evaluation**, tá»± Ä‘á»™ng hÃ³a (SOAR), Ä‘o lÆ°á»ng **risk & compliance**.

### 5.8 Kiáº¿n trÃºc phÃ²ng lab & ká»‹ch báº£n doanh nghiá»‡p
- **Enterprise 1â€“4**, **Branch**, **Coffee Shop**, **Management & Orchestration**, **Cloud (AWS/Azure)**.  
- Má»¥c tiÃªu: chá»©ng minh liÃªn hoáº¡t Ä‘á»™ng Ä‘a nhÃ  cung cáº¥p, mÃ´i trÆ°á»ng há»—n há»£p onâ€‘prem + cloud + remote.

### 5.9 NÄƒng lá»±c tiÃªu biá»ƒu cá»§a vendor
- **Ping Identity**
  - **PingAccess**: quáº£n lÃ½ truy cáº­p, triá»ƒn khai linh hoáº¡t (SaaS, cloud riÃªng, onâ€‘prem, airâ€‘gap).  
  - **PingDirectory**: directory hiá»‡u nÄƒng cao cho hÃ ng triá»‡u danh tÃ­nh; há»— trá»£ LDAP/JDBC/SCIM; mÃ£ hÃ³a, log kÃ½ sá»‘, LB/rate limiting/proxy tÃ­ch há»£p.
- **Radiant Logic**
  - **RadiantOne Platform**: **Identity Data Fabric** â€“ há»£p nháº¥t, lÃ m giÃ u dá»¯ liá»‡u danh tÃ­nh tá»« nhiá»u nguá»“n Ä‘á»ƒ phá»¥c vá»¥ ZTA theo thá»i gian gáº§n thá»±c.  
  - **Federated Identity Engine**, **Universal Directory** (FIPS 140â€‘2, LDAP/SQL/SCIM/REST), **SSO**, **Global Synchronization**.
- **SailPoint**
  - **IdentityIQ**: **Identity Governance & Administration** (IGA) â€“ lifecycle, provisioning, access request, certification, **SoD**, bÃ¡o cÃ¡o tuÃ¢n thá»§; AI/ML há»— trá»£ tá»± Ä‘á»™ng hÃ³a.

*(CÃ¹ng vá»›i cÃ¡c cá»™ng tÃ¡c viÃªn khÃ¡c: Appgate, Okta, Microsoft, Zscaler, Palo Alto Networks, Tenable, Trellix, F5, DigiCert, Broadcom, Google Cloud, IBM, Ivanti, Lookout, Mandiant, VMware, Zimperium, PC Maticâ€¦)*

---

## Phá»¥ lá»¥c A â€“ Báº£ng tá»« viáº¿t táº¯t
AAA â€“ Authentication, Authorization, Accounting  
ABAC â€“ Attributeâ€‘Based Access Control  
Acct â€“ Accounting  
CDM â€“ Continuous Diagnostics & Mitigation  
CMDB â€“ Configuration Management Database  
EDR â€“ Endpoint Detection & Response  
EIG â€“ Example Implementation Guide (ngá»¯ cáº£nh 1800â€‘35)  
IdP â€“ Identity Provider  
ICAM â€“ Identity, Credential, and Access Management  
IGA â€“ Identity Governance & Administration  
Ig â€“ Implementation Guide  
MDM â€“ Mobile Device Management  
MFA â€“ Multiâ€‘Factor Authentication  
NDR â€“ Network Detection & Response  
NTP â€“ Network Time Protocol  
OTP â€“ Oneâ€‘Time Password  
PA/PE/PEP â€“ Policy Admin/Engine/Enforcement Point  
PAP/CHAP/MSâ€‘CHAPv2 â€“ PhÆ°Æ¡ng thá»©c xÃ¡c thá»±c RADIUS  
PDU â€“ Protocol Data Unit  
PKI â€“ Public Key Infrastructure  
SASE â€“ Secure Access Service Edge  
SIEM â€“ Security Information & Event Management  
SoD â€“ Separation of Duties  
TLS/SSL â€“ Transport Layer Security / Secure Sockets Layer  
VSA â€“ Vendorâ€‘Specific Attributes  
ZTA â€“ Zero Trust Architecture

---

## Phá»¥ lá»¥c B â€“ Thuáº­t ngá»¯ nhanh
- **Least Privilege:** Cáº¥p Ä‘Ãºng quyá»n cáº§n thiáº¿t, khÃ´ng thá»«a.  
- **Continuous Evaluation:** Quyáº¿t Ä‘á»‹nh truy cáº­p cÃ³ thá»ƒ thay Ä‘á»•i khi ngá»¯ cáº£nh thay Ä‘á»•i.  
- **Microâ€‘Segmentation:** Chia nhá» miá»n máº¡ng Ä‘á»ƒ háº¡n cháº¿ lateral movement.  
- **Posture:** Tráº¡ng thÃ¡i an toÃ n thiáº¿t bá»‹ (patch, AV, disk encryptionâ€¦).  
- **Trust Algorithm:** CÃ´ng thá»©c káº¿t há»£p thuá»™c tÃ­nh + rá»§i ro Ä‘á»ƒ quyáº¿t Ä‘á»‹nh cho phÃ©p/khÃ´ng.

---

## Phá»¥ lá»¥c C â€“ Máº«u cáº¥u hÃ¬nh & lá»‡nh kiá»ƒm thá»­

### C.1 FortiGate â€“ RADIUS (CLI phÃ¡c tháº£o)
```bash
config user radius
    edit "corp-radius"
        set server "10.0.0.10"
        set secret ENC <chuoi_bi_mat>
        set auth-type mschap2
        set timeout 5
    next
end

# Táº¡o user group trá» tá»›i RADIUS
config user group
    edit "grp-rad-users"
        set member "corp-radius"
    next
end

# Ãp dá»¥ng trong policy (vÃ­ dá»¥ captive portal / SSL VPN / admin)
# ...
```

### C.2 Kiá»ƒm thá»­ RADIUS
```bash
diagnose test authserver radius corp-radius alice 'Password@123'
# â†’ success/failure + group membership
```

### C.3 Kiá»ƒm tra TCP/UDP
```bash
# Báº¯t tay TCP
tcpdump -nn -i any 'tcp[tcpflags] & (tcp-syn|tcp-ack) != 0'

# Kiá»ƒm tra UDP port
nc -vzu target.example.com 1812
```

---

## Phá»¥ lá»¥c D â€“ Tip ghi nhá»› & lá»™ trÃ¬nh Ã´n táº­p
**Nhá»› thá»© tá»± OSI (7â†’1):** *All People Seem To Need Data Processing.*  
**Mapping nhanh:** App=HTTP/DNS, Pres=TLS/Codec, Sess=State, Trans=TCP/UDP, Net=IP, Link=Ethernet/Wiâ€‘Fi, Phy=Bit.

**Lá»™ trÃ¬nh 7 ngÃ y (gá»£i Ã½):**
- **NgÃ y 1:** OSI tá»•ng quan + bÃ i táº­p PDU/mapping.
- **NgÃ y 2:** Transport (TCP/UDP) + báº¯t tay/timeout/window.
- **NgÃ y 3:** AAA/RADIUS â€“ message, port, phÆ°Æ¡ng thá»©c, VSA.
- **NgÃ y 4:** FortiGate RADIUS â€“ cáº¥u hÃ¬nh + kiá»ƒm thá»­ lab.
- **NgÃ y 5:** ZTA cÄƒn báº£n â€“ PE/PA/PEP, ABAC, posture.
- **NgÃ y 6:** ZTA theo use case â€“ VPN, SaaS, app ná»™i bá»™; stepâ€‘up auth.
- **NgÃ y 7:** Ã”n táº­p + checklist triá»ƒn khai tháº­t (Crawlâ†’Walkâ†’Run).

---

### Háº¿t

================================================================================

--- FILE: check\vpn_guide.md ---
# ğŸ” VPN (Virtual Private Network) â€“ HÆ°á»›ng dáº«n cho Developer

## 1. KhÃ¡i niá»‡m
VPN lÃ  má»™t **máº¡ng riÃªng áº£o** Ä‘Æ°á»£c thiáº¿t láº­p trÃªn háº¡ táº§ng máº¡ng cÃ´ng cá»™ng (Internet), cho phÃ©p:
- **MÃ£ hÃ³a (Encryption)**: ToÃ n bá»™ traffic giá»¯a client â†” VPN server Ä‘Æ°á»£c mÃ£ hÃ³a.
- **Äá»‹nh tuyáº¿n (Routing)**: Traffic tá»« client Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n qua VPN server trÆ°á»›c khi Ä‘áº¿n Ä‘Ã­ch.
- **áº¨n IP**: Server/website chá»‰ tháº¥y IP cá»§a VPN server, khÃ´ng tháº¥y IP thá»±c.

ğŸ‘‰ Tá»« gÃ³c nhÃ¬n dev: VPN giá»‘ng nhÆ° má»™t **network overlay** hoáº¡t Ä‘á»™ng á»Ÿ táº§ng OSI Layer 3 (Network Layer), thiáº¿t láº­p má»™t **tunnel** encapsulating IP packets.

---

## 2. MÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng

### ğŸ”¹ Truy cáº­p Internet khÃ´ng dÃ¹ng VPN
```ascii
[Client Device] ---ISP---> [Destination Server]
       | (IP tháº­t, data raw, dá»… bá»‹ sniff)
```

### ğŸ”¹ Truy cáº­p Internet qua VPN
```ascii
[Client Device] --Encrypted Tunnel--> [VPN Server] ---> [Destination Server]
       |                 |                 |
       |   Data mÃ£ hÃ³a   |   Giáº£i mÃ£       |  IP hiá»ƒn thá»‹ = IP VPN
       |   (AES, TLS)    |                 |
```

- ISP chá»‰ tháº¥y client káº¿t ná»‘i Ä‘áº¿n **VPN server**, khÃ´ng tháº¥y website tháº­t.
- Destination server tháº¥y request Ä‘áº¿n tá»« **VPN server IP**, khÃ´ng pháº£i IP tháº­t cá»§a client.

---

## 3. Ká»¹ thuáº­t cá»‘t lÃµi
- **Tunneling**: GÃ³i tin gá»‘c (original packet) Ä‘Æ°á»£c bá»c (encapsulated) trong má»™t gÃ³i má»›i.  
  VÃ­ dá»¥: `IP over UDP`, `IPSec over IP`.
- **Encryption**: 
  - AES-256 (phá»• biáº¿n trong OpenVPN, WireGuard).
  - ChaCha20 (dÃ¹ng trong WireGuard).
- **Authentication**:  
  - Username/password, certificate, hoáº·c EAP (Extensible Authentication Protocol).
- **Key Exchange**: Diffieâ€“Hellman, Elliptic Curve DH, IKEv2.

---

## 4. Giao thá»©c VPN phá»• biáº¿n
| Protocol | Layer | Æ¯u Ä‘iá»ƒm | NhÆ°á»£c Ä‘iá»ƒm |
|----------|-------|---------|------------|
| PPTP | L2 | Dá»… cÃ i, nhanh | Báº£o máº­t yáº¿u (deprecated) |
| L2TP/IPSec | L2 + L3 | Báº£o máº­t khÃ¡ | Tá»‘c Ä‘á»™ cháº­m do double encapsulation |
| OpenVPN | L4 (TCP/UDP) | Linh hoáº¡t, open-source, máº¡nh | Cáº¥u hÃ¬nh phá»©c táº¡p hÆ¡n |
| IKEv2/IPSec | L3 | á»”n Ä‘á»‹nh, reconnect nhanh | KhÃ³ triá»ƒn khai cross-platform |
| WireGuard | L3 | Codebase nhá», nhanh, secure | ChÆ°a phá»• biáº¿n trÃªn táº¥t cáº£ OS |

---

## 5. TrÆ°á»ng há»£p sá»­ dá»¥ng cho Developer
- **Remote DevOps**: SSH vÃ o server ná»™i bá»™ qua VPN thay vÃ¬ má»Ÿ port public.
- **Secure API Access**: Giá»›i háº¡n API chá»‰ cho phÃ©p gá»i tá»« IP cá»§a VPN.
- **CI/CD Pipeline**: Build agent káº¿t ná»‘i qua VPN vÃ o network cÃ´ng ty.
- **Game Development**: Che giáº¥u traffic test, trÃ¡nh bá»‹ sniff packet khi dev game online.
- **Bypass Geo-block**: Test app/web tá»« nhiá»u quá»‘c gia.

---

## 6. Æ¯u â€“ NhÆ°á»£c Ä‘iá»ƒm

### Æ¯u Ä‘iá»ƒm
- ğŸ›¡ï¸ Báº£o máº­t dá»¯ liá»‡u traffic.
- ğŸ•¶ï¸ áº¨n danh IP tháº­t.
- ğŸŒ VÆ°á»£t kiá»ƒm duyá»‡t Internet.
- ğŸ–¥ï¸ Cho phÃ©p remote access vÃ o LAN cÃ´ng ty.

### NhÆ°á»£c Ä‘iá»ƒm
- ğŸŒ Overhead mÃ£ hÃ³a â†’ tá»‘c Ä‘á»™ giáº£m.
- ğŸ“Š VPN provider cÃ³ thá»ƒ log traffic (náº¿u khÃ´ng chá»n cáº©n tháº­n).
- ğŸš« Má»™t sá»‘ dá»‹ch vá»¥ detect & block IP VPN.

---

## 7. SÆ¡ Ä‘á»“ network tá»•ng quÃ¡t

```ascii
+-----------+         +-----------+         +------------------+
|  Client   | ======> | VPN Server| ======> | Destination Host |
|  (Laptop) |  TLS    |  (Gateway)|   IP    |   (Web/API/Game) |
+-----------+         +-----------+         +------------------+
       ^                    ^
       |                    |
   Encrypt traffic      Decrypt traffic
```

---

## 8. Best Practices cho Dev
- Sá»­ dá»¥ng **WireGuard** hoáº·c **OpenVPN** thay vÃ¬ PPTP.
- DÃ¹ng **Split tunneling** khi khÃ´ng cáº§n táº¥t cáº£ traffic Ä‘i qua VPN (giáº£m latency).
- Triá»ƒn khai **Self-hosted VPN** (vd: OpenVPN, WireGuard trÃªn VPS) khi muá»‘n toÃ n quyá»n kiá»ƒm soÃ¡t.
- LuÃ´n kiá»ƒm tra **DNS Leak** vÃ  **WebRTC Leak** khi dev á»©ng dá»¥ng web liÃªn quan Ä‘áº¿n báº£o máº­t.
- Vá»›i microservices: cÃ³ thá»ƒ dÃ¹ng VPN Ä‘á»ƒ ná»‘i cÃ¡c cluster trÃªn nhiá»u cloud provider.

---

## 9. Káº¿t luáº­n
VPN khÃ´ng chá»‰ Ä‘á»ƒ "fake IP" hay "xem Netflix US" ğŸ˜„.  
Vá»›i developer, nÃ³ lÃ  **má»™t cÃ´ng cá»¥ háº¡ táº§ng quan trá»ng** giÃºp:
- Thiáº¿t láº­p mÃ´i trÆ°á»ng dev/test an toÃ n.
- Báº£o máº­t káº¿t ná»‘i Ä‘áº¿n resource ná»™i bá»™.
- Kiá»ƒm thá»­ á»©ng dá»¥ng tá»« nhiá»u region.

================================================================================

